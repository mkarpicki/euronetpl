(function(){ovi.provide("nokia.maps.util.proto");(function(){var e={}.toString,k=nokia.maps.util.proto=function(h,d,c,g){var b=Function(),f,q;b.prototype=d;b=new b;for(f in h)h.hasOwnProperty(f)&&(b[f]=c&&f in d&&e.call(q=h[f])==="[object Object]"?k(q,d[f],c):h[f]);if(c&&!g)for(f in d)if(d.hasOwnProperty(f)&&(q=d[f])===b[f]&&e.call(q)==="[object Object]")b[f]=k(0,q,c);return b}})();ovi.provide("nokia.maps.map.render.p2d._helpers");
(function(e){ovi.extend(e,{geoToScreen:function(e,h){var d=h.geoToPixel(e),c=h.w;d.x-=Math.round(d.x/c)*c;return d}})})(nokia.maps.map.render.p2d._helpers);ovi.provide("nokia.maps.util.Event");(function(e){var k=e.now,e=e.Event=function(e){this.type=""+e;this.timeStamp=k()};ovi.extend(e.prototype,{target:null,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}})})(nokia.maps.util);ovi.provide("nokia.maps.util.Cache");
(function(e){function k(a,b,c,f){this.c=a;this.H=b;if(this.f!==f)this.f=f;if(c)(c.Y=this).W=c}function h(a,c){b.H=a;b.f=c===void 0?1:c;return b}function d(a){return a===void 0?1:isNaN(a=+a)||a<0||a===q?e.d():a}var c={},g={},b={},f={},q=1/0;e.Cache=new ovi.Class({initialize:function(a,b,c,f){this.Tb=d(a);if(b)this.Pd=b;if(c)this.we=c;if(f)this.X=f;this.q={}},Statics:{DONT:c,NEXT:g,NOT_ENOUGH_SPACE:f,change:h},f:0,change:h,add:function(a,e,l){var h=this.Pd,p=this.X,q=this.q,s=q[a],v;if(h){if((h=h(e))===
g)return s&&this.remove(a,1),p?p.add(a,e,l):g;if(h===c)return s&&this.remove(a),c;h===b?(e=h.H,l=h.f):e=h}if((l=d(l))>this.Tb)return p?p.add(a,e,l):f;if(s)this.f+=l-s.f,s.H=e,s.f=l,this.Ub(s);else{s=q[a]=this.V=new k(a,e,this.V,l);if(!this.fa)this.fa=s;this.f+=l}for(;this.f>this.Tb;)this.R((v=this.fa).c,v),p&&p.add(v.c,v.H,v.f)},get:function(a,b){var c=this.q[a],f;c&&(b||this.Ub(c));return c?c.H:(f=this.X)?f.get(a,b):void 0},remove:function(a,b){var c=this.q[a],f,d;c&&this.R(a,c);if(!b&&(f=this.X))d=
f.remove(a,b);return c?c.H:d},removeAll:function(a){var b=this.q,c,f;for(c in b)b.hasOwnProperty(c)&&!c.indexOf(a)&&this.R(c,b[c]);(f=this.X)&&f.removeAll(a)},destroy:function(){var a=this.q,b,c;for(c in a)(b=a[c]).W=0,b.Y=0;this.fa=this.V=0;this.X&&this.X.destroy()},R:function(a,b,c){var f=b.Y,d=b.W,e;f?d?(f.W=d).Y=f:(this.fa=f).W=void 0:(this.V=d)?d.Y=void 0:this.fa=void 0;if(!c)delete this.q[a],this.f-=b.f,(e=this.we)&&e(b.H);return b.H},Ub:function(a){var b=this.V;if((b=this.V)!==a){this.R(a.c,
a,1);if(b)(b.Y=a).W=b;(this.V=a).Y=void 0}}});k.prototype.f=1})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.IData");ovi.provide("nokia.maps.map.provider.IObjectProvider");ovi.provide("nokia.maps.util.Arrows");
(function(e){var k=nokia.maps.gfx.Color,h={color:1,width:1,length:1,frequency:1};e.Arrows=new ovi.Class({width:1.2,length:1.6,frequency:5,color:"#FFFC",initialize:function(d){var c,g,b=e.d;if(typeof d==="object")for(c in h)h.hasOwnProperty(c)&&c in d&&(g=d[c],c==="color"?k.parseCss(g)===null&&b(c):g<=0&&b(c),this[c]=d[c])}})})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.Tile");
(function(){var e=nokia.maps,k=e.dom.importNode,h=e.dom.cloneNode;ovi.extend((nokia.maps.map.provider.Tile=function(d,c,e){this.id=d;if(c)(this.data=c).style.position="absolute";this.Bi=(this.e=e)?e.getInvalidationMark():void 0}).prototype,{Bi:-1/0,rk:1,state:void 0,getInvalidations:function(d){return this.e.getInvalidations(this,d)},getNode:function(d){var c=this.data,e;return c&&(d&&d!==document&&k(d,c,1)||(e=c.parentNode)&&e.nodeType!==11&&h(c,1)||c)}})})();ovi.provide("nokia.maps.map.render.p2d.Animation");
(function(e){var k=e.util,h=k.requestAnimationFrame,d=k.cancelAnimationFrame,c=e.util.now;e.map.render.p2d.Animation=ovi.Class({initialize:function(c,b,f,d){this.duration=d||300;this.Uv=c;this.qq=b;if(typeof f==="function")this.Kl=f;this.isRunning=!1},start:function(){function d(){var e=c(),a=e-b.Jd,k=a/b.duration,k=k>1?1:k;b.Kl&&(k=b.Kl(k));b.Uv(k,a,e-f,e);f=e;k>=1?b.stop():b.Go=h(d)}var b=this,f;b.Jd=c();f=b.Jd;b.isRunning=!0;b.Go=h(d)},stop:function(c){d(this.Go);this.isRunning=!1;c||this.qq&&
this.qq()}})})(nokia.maps);ovi.provide("nokia.maps.map.render.Preloader");
nokia.maps.map.render.Preloader=new ovi.Class({initialize:function(e,k){this.ra=ovi.bind(this,this.ra);this.Pq=e;this.vq=k;this.Hv=setTimeout(ovi.bind(this,this.pd));this.Um={};this.mn=[]},total:0,past:0,pd:function(){for(var e=this.Pq,k=e.length,h=0,d,c,g,b,f,q,a=0,r=0,l=this.Um,m;h<k;++h){this.mn.push(c=e[h]);providers.addListener("response",this.ra);d=e[++h];f=e[++h];g=c.request;b=c.createId;argsLength=f.length;for(q=0;q<argsLength;)++a,g.apply(c,m=f.slice(q,q+=d))===TRUE?l[b.apply(c,m)]=1:++r}this.Pq=
0;this.state=1;this.total=a;this.past=r;this.vq()},ra:function(e){var e=e.data[0],k=this.Um;if(k[e]){k[e]=0;if(++this.past===this.total)this.Um=0;this.vq()}},Ew:function(){for(var e=that.mn.length;e--;)that.mn[e].removeListener("response",that.ra)},state:0,cancel:function(){clearTimeout(this.Hv)}});ovi.provide("nokia.maps.map.render.InteractionRecorder");
(function(e){var k=e.util.Vector3D;e.map.render.InteractionRecorder=new ovi.Class({initialize:function(e){e=e||{};this.Lr=e.toleraceX||3;this.Mr=e.toleraceY||3;this.iq=e.maxSpeed||300;this.Sv=e.timeDelta||300;this.kp=e.directionTolerance||3;this.reset()},reset:function(){this.Rq=[]},setTollerance:function(e,d){this.Lr=e||3;this.Mr=d||3},recordXY:function(e,d,c,g,b){e||(e=(new Date).getTime());this.Rq.push({x:d,y:c,bx:g,by:b,time:e})},getRecorded:function(e){var d=this.Rq,c=d.length,g;e||(e=(new Date).getTime());
g=e-this.Sv;if(c===0||c>0&&g>d[c-1].time)return[];for(;c--;)if(e=d[c],e.time<g)return d.slice(c,d.length);return d},Xl:function(e,d){return e.bx===+e.bx&&d.bx===+d.bx?{dx:d.x+(d.bx-d.x)/2-(e.x+(e.bx-e.x)/2),dy:d.y+(d.by-d.y)/2-(e.y+(e.by-e.y)/2)}:{dx:d.x-e.x,dy:d.y-e.y}},getInteractionDirection:function(e){var e=this.getRecorded(e),d=e.length,c=this.kp>1?this.kp:2;d>1?(e=this.Xl(e[d-(c>d?d:c)],e[d-1]),e=new k(e.dx,e.dy,0)):e=new k(0,0,0);return e.normalize()},Fs:function(e,d){var c=this.Xl(e,d);return Math.abs(c.dx)>
this.Lr||Math.abs(c.dy)>this.Mr},getInteractionSpeed:function(e){var e=this.getRecorded(e),d=e.length,c=0,c=0,g,b;if(d>1&&this.Fs(e[d-1],e[d-2])){c=0;for(b=1;b<d;b++)g=this.Xl(e[b-1],e[b]),c+=Math.sqrt(g.dx*g.dx+g.dy*g.dy);c/=d-1;return c<=this.iq?c:this.iq}else return 0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.KineticMove");
(function(e){e.map.render.KineticMove=new ovi.Class({initialize:function(e,h){this.Mk=h||0.5;this.Lc=this.Qn=0;e&&this.setInitialSpeed(e)},setInitialSpeed:function(e){this.Qn=e;this.Lc=this.getDuration()},getValue:function(e){return this.Qn+this.Mk*e},getPath:function(e){return Math.abs(this.Mk*e*e/2)},getDuration:function(){return this.Qn/this.Mk}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.ILayer");ovi.provide("nokia.maps.map.render.p2d.dom.ImageLayer");
(function(){var e=nokia.maps,k=e.util,h=e.map.render.p2d.dom,d=e.dom,c={state:!1};h.ImageLayer=function(c,b,f,d){this.e=b;this.Da=d;this.o=c;this.Fd=b.opacity||1;this.Qj=ovi.bind(this,this.Qj);this.kf=c.ownerDocument};h.ImageLayer.prototype={sc:-1/0,sa:e.util.A,shutdown:function(){this.Da=k.A;this.Qj=e.util.A;this.stop();d.bc(this.o);return this.o},stop:function(){this.zl&&this.zl.abort()},show:function(){this.lr("")},hide:function(){this.lr("none")},lr:function(c){this.o.style.display=c},render:function(d,
b,f,e,a,h,l,k,p,z,s,v){var b=this.e,e=this.sc,u;this.sv=h;if(d>=b.min&&d<=b.max){this.Th=f;if(b.getInvalidations(e)&&(this.zl=u=b.request(l,v,this.Qj))&&u.state)this.Wp=u,this.sc=b.getInvalidationMark();(u=this.Wp)&&this.Gk(u)}else this.Gk(c)},Qj:function(c){if(c.state)this.Wp=c;this.zl===c&&this.Gk(c)},Gk:function(c){var b,f,e,a,h;b=this.o;var l=b.firstChild;e=c.bbox;f=c.data;c=this.Fd;f?(l||(l=this.kf.createElement("img")),h=this.Th,l.src=f.src,b=h.geoToPixel(e.topLeft).round(),f=h.geoToPixel(e.bottomRight).round(),
a=f.x-b.x,a=e.isCDB?a+h.w:a,h=b.x-h.w,h=b.x<Math.abs(h)?b.x:h,e=l.style,e.position="absolute",e.left=h+"px",e.top=b.y+"px",e.width=a+"px",e.height=f.y-b.y+"px",c!==1&&d.Hd(l,c),this.o.appendChild(l)):l&&b.removeChild(l)},capture:function(c,b,f){var d=this.o.childNodes,a;a=this.sv;var e=d.length,l=0;b-=a.x;f-=a.y;c.save();for(c.set("opacity",this.Fd);l<e;l++)a=d[l],c.drawImage(a,0,0,a.naturalWidth||a.width,a.naturalHeight||a.height,a.offsetLeft-b,a.offsetTop-f,parseInt(a.style.width,10),parseInt(a.style.height,
10));c.restore()}}})();ovi.provide("nokia.maps.map.render.p2d.dom.CanvasLayer");
(function(){var e=nokia.maps,k=e.dom,h=e.map.render.p2d.dom;h.CanvasLayer=function(d,c,e){var c=new h.ImageLayer(d,c,0,e),b=d.ownerDocument;c.Gk=function(c){var d,a,e,g,h,p=this.o.firstChild;e=c.bbox;d=c.data;c=this.Fd;p?this.o.removeChild(p):p=b.createElement("canvas");if(d)h=this.Th,p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0),d=h.geoToPixel(e.topLeft).round(),a=h.geoToPixel(e.bottomRight).round(),g=a.x-d.x,g=e.isCDB?g+h.w:g,h=d.x-h.w,h=d.x<Math.abs(h)?d.x:h,e=p.style,e.position=
"absolute",e.left=h+"px",e.top=d.y+"px",e.width=g+"px",e.height=a.y-d.y+"px",c!==1&&k.Hd(p,c),this.o.appendChild(p)};return c}})();ovi.provide("nokia.maps.map.IView");ovi.provide("nokia.maps.map.ICam");ovi.provide("nokia.maps.map._EngineTransition");
(function(e){var k=ovi.extend,h={"2d-3d":void 0,"3d-2d":{},"2d-panorama":{altitude:27.26},"panorama-2d":{altitude:27.26,pitch:0,yaw:0},"3d-panorama":{pitch:0,altitude:20},"panorama-3d":{pitch:0}},d={"2d-3d":{},"3d-2d":void 0,"2d-panorama":{pitch:90},"panorama-2d":{altitude:27.26},"3d-panorama":{pitch:90},"panorama-3d":{pitch:0}};e.map.$r=new ovi.Class({start:function(){this.inProgress=!0},finish:function(){this.inProgress=!1},getHandoverCam:function(c,d,b){c=h[d+"-"+c];return c===void 0?c:k({},b,
c)},getDestinationCam:function(c,e,b){c=d[e+"-"+c];return c===void 0?c:k({},b,c)}})})(nokia.maps);ovi.provide("nokia.maps.language.Manager");
(function(e){var k=e.util.getRootNameSpace("nokia.maps").Language;e.language.Manager=ovi.Class({translateToken:function(e,d,c){c=c||k.translations;c=c[e];d&&c==null&&ovi.warn("Translation: Cannot translate token: "+e);return c||e},translate:function(h,d,c){var c=c||/__i18n_([a-z\.]*_[a-z0-9]*)__/g,g=this,b=k.translations;return h.replace(c,function(c,h){(h==null||typeof h==="number")&&e.util.d("keyRegexp does not contain a valid token group");return g.translateToken(h,d,b)})}})})(nokia.maps);ovi.provide("nokia.maps.map.HitArea");
(function(){var e=Math,k=e.PI/180,h=e.ceil,d=e.min,c=e.sin,g=e.cos,b=nokia.maps.util,f=b.Point,q=nokia.maps.map.HitArea=new ovi.Class({initialize:function(a,f){var e=(f=[].concat(f)).length,m=e,p,q,s,v,u;this.values=f;for(this.type=a;m--;)isNaN(f[m]=f[m])&&b.d("Given argument is not the array of numbers");a==="rect"&&e>3&&(f=[+f[0],+f[1],+f[2],+f[1],+f[2],+f[3],+f[0],+f[3]],a="poly");if(a==="circle"&&e>2&&(s=+f[2])>0){p=+f[0];q=+f[1];m=d(h(s)*2,40);v=360/m;for(f=[];m--;)u=v*m*k,f.push(p+c(u)*s,q+
g(u)*s);a="poly"}if(a==="poly"&&e&&!(f.length%2))this.Zb=f;!this.Zb&&b.d("bad polygon")},Statics:{from:function(a){return a instanceof q?a:new q(a.type,a.values?a.values:a.coords)}},hitTest:function(a,b,c){return f.isCoveredBy(a,b,this.Zb,c,!0)}})})();ovi.provide("nokia.maps.util.ColorHelper");
(function(e){function k(a){var b;if(a.charAt(0)==="#")b=f[a.length]?a:null;else if(a.substr(0,3)==="rgb"){b=a.match(/\d+(\.\d+)?/g);var c=b.length;b=c>2&&c<5?["#",d(+b[0]),d(+b[1]),d(+b[2]),c>3?d(+b[3]*255):"ff"].join(""):null}b||e.d("Invalid color definition: "+a);return b}function h(a){return!/^(#|rgb).*/.test(a)}function d(a){return a<16?"0"+g(a).toString(16):g(a).toString(16)}function c(a){a=b(a,16);return(a<<4)+a}var g=Math.round,b=parseInt,f={4:function(a){return["#",a.charAt(1),a.charAt(1),
a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),"ff"].join("")},5:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),a.charAt(4),a.charAt(4)].join("")},7:function(a){return a+"ff"},9:function(a){return a}},q={4:function(a){return[c(a.charAt(1)),c(a.charAt(2)),c(a.charAt(3)),255]},5:function(a){return[c(a.charAt(1)),c(a.charAt(2)),c(a.charAt(3)),c(a.charAt(4))]},7:function(a){a=b(a.substring(1),16);return[a>>16&255,a>>8&255,a&255,255]},9:function(a){a=b(a.substring(1),
16);return[a>>24&255,a>>16&255,a>>8&255,a&255]}};e.ColorHelper={toInternal:function(a){return h(a)?a:(a=k(a),f[a.length]?f[a.length](a):a)},toRGBA:function(a,b){return h(a)?[0,0,0,255]:(b||(a=k(a)),q[a.length](a))},getHex3:function(a,b){return h(a)?a:(b||(a=k(a),a=f[a.length]?f[a.length](a):a),a.substr(0,7))},getAlpha:function(a,c){return h(a)?1:(c||(a=k(a),a=f[a.length]?f[a.length](a):a),b(a.substr(7,2),16)/255)},toRandomRGBA:function(a,b){if(h(a))return"000000ff";else{for(var a=this.toRGBA(a,b),
c=0;c<4;c++)a[c]=""+d(c<3?Math.floor(Math.random()*(a[c]-0+1))+0:a[c]);return a.join("")}}}})(nokia.maps.util);ovi.provide("nokia.maps.map._packaging.components-nokia");ovi.provide("nokia.maps.dom.KeyCodes");
(function(){function e(d,c){for(var e=c.length;e--;)k[c[e]]=d+e}var k={BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,META:91,CONTEXT_MENU:93,CMD_LEFT:91,CMD_RIGHT:93};e(32,["SPACE","PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN"]);e(44,["PRINT_SCREEN","INSERT","DELETE"]);e(48,["ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE"]);e(96,["NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN",
"NUM_EIGHT","NUM_NINE"]);e(112,["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"]);for(var h=65;h<=90;h++)k[String.fromCharCode(h).toUpperCase()]=h;nokia.maps.dom.KeyCodes=k})();ovi.provide("nokia.maps.map.render.Capabilities");
(function(){if(!nokia.maps.util.getConstructor(nokia.maps.map.render.Capabilities))var e=nokia.maps,k={min:0,max:0},h=(e.map.render.Capabilities=function(d){return e.util.proto(d,h,!0,!0)}).prototype={view:{heading:k,tilt:k,incline:k,distance:k,zoom:{min:-1/0,max:1/0}},cam:{fov:{min:70,max:70}},altMode:{GL:!0,OL:!1,SL:!1,SB:!1,WE:!1,WG:!1},provider:{tile:{bmp:!0,gfx:!1,mesh:!1},object:{spatial:!0,marker:!0,decal:!1}},ui:17,capture:!1,ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16,FOV:32,SIZE:64}})();
ovi.provide("nokia.maps.util.EventTarget");
(function(e){var e=e.EventTarget=function(e){var e=e||this,d;if(!e.au)for(d in k)d in e||(e[d]=k[d]);return e},k={au:!0,addListener:function(e,d){var c=this.Yk||(this.Yk={}),c=c[e]||(c[e]=ovi.Array([]));c.indexOf(d)<0&&c.push(d)},removeListener:function(e,d){var c=this.Yk,g,b;if(c&&(g=c[e]))b=g.indexOf(d),b>=0&&(g.splice(b,1),b<=g.Ba&&--g.Ba),g.length||delete c[e]},dispatch:function(e){var d=this.Yk,c;e.target=this;if(d&&(c=d[e.type])){for(d=0;d<c.length;d++)c.Ba=d,c[d].call(this,e),d=c.Ba;c.Ba=NaN}return!e.defaultPrevented}};
ovi.extend(e.prototype,k)})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.NullObjectProvider");(function(e){e.map.provider.NullObjectProvider=new ovi.Class({cg:function(){},Wh:function(){},rc:function(){},requestBBox:function(){return[]},cancelBBoxRequest:function(){},adopt:function(e){if(e.e)return!1;e.e=this;return e},orphan:function(e){if(e.e!==this)return!1;e.e=null;return e}})})(nokia.maps);ovi.provide("nokia.maps.geo.PixelProjection");
(function(e){var k=e.util,h=k.Point,d=k.d,e=e.geo.PixelProjection=function(c,e,b,f,h){(this.p=c)&&(this.w=+e)>0&&(this.h=+b)>0||d();if(f)this.x=+f;if(h)this.y=+h};ovi.extend(e.prototype,{x:0,y:0,geoToPixel:function(c){c=this.p.latLngToPoint(c.latitude,c.longitude);return new h(c.x*this.w-this.x,c.y*this.h-this.y)},latLngToPixel:function(c,d){var b=this.p.latLngToPoint(c,d);return new h(b.x*this.w-this.x,b.y*this.h-this.y)},pointToPixel:function(c){return new h(c.x*this.w-this.x,c.y*this.h-this.y)},
xyToPixel:function(c,d){return new h(c*this.w-this.x,d*this.h-this.y)},pixelToPoint:function(c){return new h((c.x+this.x)/this.w,(c.y+this.y)/this.h)},xyToPoint:function(c,d){return new h((c+this.x)/this.w,(d+this.y)/this.h)},pixelToGeo:function(c){return this.p.xyToGeo((c.x+this.x)/this.w,(c.y+this.y)/this.h)},xyToGeo:function(c,d){return this.p.xyToGeo((c+this.x)/this.w,(d+this.y)/this.h)}})})(nokia.maps);ovi.provide("nokia.maps.map.component.KeyControl");
(function(e){function k(){this.values={}}function h(b,c,d,a,e,g,h,k){this.bu=b;this.mq=c;this.nq=d;this.oq=a;this.er=e;this.gr=g;this.hr=h;this.Yr=k}var d=e.map.component,c=e.dom.KeyCodes,g={duration:function(){return 600},power:function(){return 0.35},ease:e.util.animation.easeFunctions.EASE_OUT_CIRC};h.prototype={applies:function(b){var f=this.bu,d=f&1024,a=f&2048,e=f&4096,g=f&8192;(f=b[f-(d?1024:0)+(a?2048:0)+(e?4096:0)+(g?8192:0)])&&(f=d&&b[c.SHIFT]||!d&&!b[c.SHIFT]);f&&(f=a&&b[c.CTRL]||!a&&!b[c.CTRL]);
f&&(f=e&&b[c.ALT]||!e&&!b[c.ALT]);f&&(f=g&&b[c.META]||!g&&!b[c.META]);return f}};k.prototype={add:function(b,c,d,a,e,g,k,p){this.values[b]=new h(b,c,d,a,e,g,k,p)},isMapped:function(b){var c=this.values,d;for(d in c)if(c.hasOwnProperty(d)&&d&b)return!0},remove:function(b){delete this.values[b]},query:function(b){var c=[],d=this.values,a;for(a in d)d[a].applies(b)&&c.push(d[a]);return c}};k.MOD_SHIFT=1024;k.MOD_ALT=1024;k.MOD_CTRL=1024;k.MOD_META=8192;d.KeyControl=new ovi.Class({c:"KeyControl",n:"0.0.0.1",
Extends:d.Component,Statics:{CAM_KEYMAP:function(){var b=new k;b.add(c.UP,0,0,0,-0.015);b.add(c.DOWN,0,0,0,0.015);b.add(c.LEFT,0,0,0,0,0.015);b.add(c.RIGHT,0,0,0,0,-0.015);b.add(1024|c.RIGHT,0,0,0,0,-0.015);b.add(1024|c.LEFT,0,0,0,0,0.015);b.add(1024|c.UP,0,0,0,-0.015);b.add(1024|c.DOWN,0,0,0,0.015);b.add(107,0,0,0,0,0,0,0.02);b.add(109,0,0,0,0,0,0,-0.02);b.add(187,0,0,0,0,0,0,0.02);b.add(189,0,0,0,0,0,0,-0.02);b.add(171,0,0,0,0,0,0,0.02);b.add(173,0,0,0,0,0,0,-0.02);return b}(),VIEW_KEYMAP:function(){var b=
new k;b.add(c.UP,0,0.002);b.add(c.DOWN,0,-0.002);b.add(c.LEFT,-0.002);b.add(c.RIGHT,0.002);b.add(107,0,0,0.001);b.add(109,0,0,-0.001);b.add(187,0,0,0.001);b.add(189,0,0,-0.001);b.add(171,0,0,0.001);b.add(173,0,0,-0.001);b.add(1024|c.RIGHT,0,0,0,0,0.015);b.add(1024|c.LEFT,0,0,0,0,-0.015);b.add(1024|c.UP,0,0,0,0.015);b.add(1024|c.DOWN,0,0,0,-0.015);return b}(),KeyMap:k},initialize:function(){this.xj=ovi.bind(this,this.xj);this.yj=ovi.bind(this,this.yj);this.af=ovi.bind(this,this.af);this.Xa=ovi.bind(this,
this.Xa);this.Uk=ovi.bind(this,this.Uk);this.wm=0;this.Cs=d.KeyControl.CAM_KEYMAP;this.ew=d.KeyControl.VIEW_KEYMAP;this.Ze=null;this.Hn("view");this.Xd={}},attach:function(b){this._super(b);b.addListener("keydown",this.xj);b.addListener("keyup",this.yj);b.addListener("blur",this.af);b.addListener("focus",this.af);b.addListener("dragstart",this.Xa)},detach:function(b){b.removeListener("keydown",this.xj);b.removeListener("keyup",this.yj);b.removeListener("blur",this.af);b.removeListener("focus",this.af);
b.removeListener("dragstart",this.Xa);this._super(b)},Hn:function(b){this.Us=b;switch(b){case "cam":this.Ze=this.Cs;break;case "view":this.Ze=this.ew}},Xk:function(b,c){b.zoom=c?Math.ceil(b.zoom):Math.floor(b.zoom);b.distance=void 0;return b},Uk:function(b,c){return this.Xk(ovi.extend({},c),c.zoom-b.zoom>0)},hs:function(){return!1},op:function(b){var c=b.length,d=c,a,e,l,h,k,z,s,v;for(e=l=h=k=z=s=v=0;c--;)a=b[c],e===0&&(e=a.mq?a.mq:0),l===0&&(l=a.nq?a.nq:0),h===0&&(h=a.oq?a.oq:0),k===0&&(k=a.er?a.er:
0),z===0&&(z=a.gr?a.gr:0),s===0&&(s=a.hr?a.hr:0),v===0&&(v=a.Yr?a.Yr:0);d?(this.wm||this.mapDisplay.beginControl(this.Us,g),this.mapDisplay.control(null,e,l,h,k,z,s,h?0:v)):this.wm&&this.mapDisplay.endControl(this.Uk);this.wm=d},Zu:function(b){var c;this.Ze.isMapped(b)&&!this.Xd[b]&&(this.Xd[b]=1,c=this.Ze.query(this.Xd),this.op(c));return c?c.length:0},Uq:function(b){var c;this.Ze.isMapped(b)&&this.Xd[b]&&(delete this.Xd[b],c=this.Ze.query(this.Xd),this.op(c));return c?c.length:0},xj:function(b){var c=
b.nativeEvent;this.Zu(c.keyCode||c.which)&&b.preventDefault()},yj:function(b){b=b.nativeEvent;this.Uq(b.keyCode||b.which)},af:function(){var b=this.Xd,c;for(c in b)this.Uq(b[c])},Xa:function(){this.mapDisplay.endControl(this.hs)},isCompatible:function(){this.mapDisplay.baseMapType===nokia.maps.map.Display.PANORAMA?this.Hn("cam"):this.Hn("view");return!0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.capabilities");var mc=nokia.maps,nc=mc.map.render,oc=mc.dom.Page.browser;
nc.p2d.capabilities=nc.Capabilities({view:{distance:{max:1/0},zoom:{min:-8,max:22}},cam:{fov:{min:70,max:70}},provider:{tile:{gfx:!0}},capture:(!oc.msie||oc.version>=9)&&!oc.webkit});ovi.provide("nokia.maps.map.provider.Provider");
(function(){var e=0,k=Math,h=k.min,d=k.max,c=[],g=nokia.maps.util.Event;nokia.maps.map.provider.Provider=new ovi.Class({methodsToBind:[],staticsToBind:[],Extends:nokia.maps.util.EventTarget,initialize:function(b){var c=this;ovi.extend(c,b);if(b&&"strictUpdate"in b&&!("strictInvalid"in b))c.strictInvalid=c.strictUpdate;c.id=e++;c.max=h(c.max,30);c.min=d(c.min,0);b=d(0,c.updateCycle);if(b>0)c.Yv=setInterval(function(){c.lo()},b*1E3);c.Va={};c.Wv=function(){c.lo();c.Ur=0};c.vs()},pType:1,min:0,max:-1,
label:"",description:"",strictUpdate:!1,strictInvalid:!1,lb:Math.pow(-2,53),providesLevel:function(b){return b>=this.min&&b<=this.max},getInvalidationMark:function(){return this.lb},update:function(){this.Ur||(this.Ur=setTimeout(this.Wv,0))},lo:function(){++this.lb;this.dispatch(new g("update"))},getCopyrights:function(){return c},shutdown:function(){clearInterval(this.Yv);delete this.rw},us:function(b){for(var c=this.methodsToBind,d=c.length;d--;)this[c[d]]=ovi.bind(b,b[c[d]])},vs:function(){for(var b=
this,c=b.staticsToBind,d=c.length;d--;)b[c[d]]=function(a){return function(){var d=b.At();return d[c[a]].apply(d,arguments)}}(d)}})})();ovi.provide("nokia.maps.map.provider.RemoteObjectProvider");
(function(e){(function(){var k;ovi.extend((k=function(e){this.pq=e}).prototype,{getBBox:function(){return this.pq.getBoundingBox()},getObject:function(){return this.pq},cancel:e.util.A});return k})();e.map.provider.RemoteObjectProvider=new ovi.Class({Extends:e.map.provider.Provider,initialize:function(e){this._super(e)},requestBBox:function(){},cancelBBoxRequest:function(){}})})(nokia.maps);ovi.provide("nokia.maps.map.provider.BitmapProvider");
nokia.maps.map.provider.BitmapProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,request:function(e,k,h){var d=this,c,g=this.getBoundingBox();if(g.intersects(e))return e=this.getId(),this.cache&&(c=this.cache.get(e)),c===void 0&&!k&&(c=this.create(e,g,k)),k||c.send(function(b){d.cache&&b.state!==void 0&&d.cache.add(b.id,b);h(b)}),c},getInvalidations:function(e){return(e<this.getInvalidationMark())*1}});ovi.provide("nokia.maps.map.provider.CanvasProvider");
(function(){function e(e,d,c){this.id=e;this.bbox=d;this.provider=c}var k;ovi.extend(e.prototype,{send:function(e){var d=this;this.data=k=k||document.createElement("canvas");this.provider.draw(this.data,function(c,g){d.state=g;d.data=c;e(d)})},abort:function(){}});nokia.maps.map.provider.CanvasProvider=new ovi.Class({Extends:nokia.maps.map.provider.BitmapProvider,initialize:function(e){this._super(e)},create:function(h,d){return new e(h,d,this)},getId:function(){return this.id},getInvalidations:function(e){return(e<
this.getInvalidationMark())*1}});nokia.maps.map.provider.CanvasProvider.Request=e})();ovi.provide("nokia.maps.map.provider.PanoramaProvider");
(function(e){function k(){var d=e.map.render.panorama&&e.map.render.panorama.Engine;d&&(d.setAppIdAndAppCode(h.app_id,h.app_code),d.setConfiguration({UseSSL:h.secureConnection==="force",RequestParam:{xnlp:"CL_JSMv"+encodeURIComponent("2.5.4")}}))}e.map.provider.PanoramaProvider=new ovi.Class({Extends:e.map.provider.Provider,methodsToBind:["getPanoramaId"],staticsToBind:["hasCoverage","isCovered","getClosestPanorama","loadCoverage"],label:"StreetLevel",initialize:function(d){this._super(d);this.pType=
2;this.min=this.max=22;this.version="newest";this.baseUrl=d.baseUrl},At:function(){return e.map.render.panorama.Engine},getCopyrights:function(d,c){return e.map.js.copyrights.get("panorama",d,c)},setTileVersion:function(d){this.version=d||"newest";this.So()},setBaseUrl:function(d){this.baseUrl=d||this.baseUrl;this.So()},So:function(){var d=e.map.render.panorama&&e.map.render.panorama.Engine;d&&typeof d.setVersion==="function"?d.setVersion(this.version):d&&typeof d.setConfiguration==="function"&&d.setConfiguration({MRSBaseUrl:"http://1."+
this.baseUrl+"rcdistonlytile/"+this.version+"/normal.day/",UseSSL:h.secureConnection==="force",RequestParam:{xnlp:"CL_JSMv"+encodeURIComponent("2.5.4")}})}});var h=nokia.maps.util.getRootNameSpace("nokia.maps").Settings;h.addObserver("app_id",k);h.addObserver("app_code",k);h.addObserver("secureConnection",k)})(nokia.maps);ovi.provide("nokia.maps.map.provider.GlobeProvider");
(function(e){e.map.provider.GlobeProvider=new ovi.Class({Extends:e.map.provider.Provider,label:"3d",initialize:function(e){this._super(e);this.pType=4;this.max=Infinity;this.min=0},getCopyrights:function(k,h){return e.map.js.copyrights.get("globe",k,h)}})})(nokia.maps);ovi.provide("nokia.maps.map.overlay.ObjectProvider");
nokia.maps.map.overlay.ObjectProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,Mixins:[nokia.maps.util.OObject],readyObjects:null,cache:nokia.maps.util.A,finishRequest:function(e,k){k&&(this.notify(e),this.cache(e))},notify:function(e){this.set("readyObjects",e)}});ovi.provide("nokia.maps.map.DisplayContainer");
(function(){var e=nokia.maps,k=e.dom,h=ovi.Array.indexOf,d=e.util;nokia.maps.map.DisplayContainer=new ovi.Class({initialize:function(c,e){function b(a){if(q.enabled){var b=v.getClientRect(p),d=+a.pageX,f=+a.pageY,e,g,l=a.type,k=a.dataTransfer,m,s=null;m=null;var z=E,y=-1;if(c.width!==c.da.offsetWidth||c.height!==c.da.offsetHeight)c.Hf(c.da.offsetWidth,c.da.offsetHeight),(a.type=="resizestart"||a.type=="resize")&&c.Cv(16);a.display=c;if(!x[l]&&d===d&&f===f&&(a.displayX=e=d-b.left,a.displayY=g=f-b.top,
l!=="drag"&&l!=="drop"&&l!=="dragend"&&l!=="dragleave"&&l!=="gesturestart"&&l!=="gesturechange"&&l!=="gestureend"))a.displayObjects=s=c.getObjectsAt(a.displayX,a.displayY);m=s&&s.length>0&&s[0]||c;if(l==="dragstart"){for(m=K(m);m&&m.length;){if(m[0]&&m[0].isDraggable)break;m.shift()}D=m=m&&m[0]||c;C=!1}else if(l==="drag")m=D;else if(k&&(l==="dragenter"||l==="dragover"||l==="dragleave")){l==="dragleave"&&(m=null);A!==m&&(l=new r({type:"dragleave",target:A,relatedTarget:D,pageX:d,pageY:f,display:c,
displayX:e,displayY:g,dataTransfer:k}),H(A,l),A=null,C=!1);if(!A&&m)l=new r({type:"dragenter",target:A=m,relatedTarget:D,pageX:d,pageY:f,display:c,displayX:e,displayY:g,dataTransfer:k}),H(A,l),C=l.defaultPrevented;C?(l=new r({type:"dragover",target:A,relatedTarget:D,pageX:d,pageY:f,display:c,displayX:e,displayY:g,dataTransfer:k}),H(A,l)):k.dropEffect="none";a.cancel();return}else if(l==="drop"){A&&C?(l=a.clone(),l.target=A,H(A,l)):k.dropEffect="none";a.cancel();return}else if(l==="dragend")a.target=
m=D,D=A=null,C=!1;else if(w[l]){if(x[l]||E&&E!==m)d=a.clone(),d.type="mouseout",d.target=E,d.relatedTarget=x[l]?a.relatedTarget:m,H(E,d),E=null;for(;++y<M.length;)if((!s||h(s,M[y])<0)&&(M[y]!==c||x[l]))d=a.clone(),d.type="mouseleave",d.target=M[y],delete d.relatedTarget,H(d.target,d),M.splice(y--,1);if(!x[l]&&!E){if(h(M,m)<0)d=a.clone(),d.type="mouseenter",d.target=m,delete d.relatedTarget,H(m,d),M.push(m);d=a.clone();d.type="mouseover";d.target=E=m;d.relatedTarget=u[l]?a.relatedTarget:z;H(E,d)}}if(!x[l]&&
!u[l])a.target=m,H(m,a,"isRemote"in m&&m.isRemote?[c]:void 0)}}function f(a,b,c){return(b in y?l:p)[a+"Listener"](b,c,void 0)}var q=this,a=k.EventTarget,r=k.Event,l=a(k.hb(e,"div")),m=k.hb(l,"div"),p=a(k.hb(m,"div")).enableDrag(),z=k.hb(l,"div"),s=k.hb(m,"div"),c=a(c).enableDrag(),v=q.ln=k.Page(p),u={mouseover:!0,mouseenter:!0},x={mouseout:!0,mouseleave:!0,blur:!0},w={mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseenter:!0,mouseleave:!0},y={keydown:!0,keyup:!0,focus:!0,blur:!0},
B={dragstart:!0,drag:!0,dragenter:!0,dragover:!0,drop:!0,dragleave:!0,dragend:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mouseup:!0,keydown:!0,keyup:!0,focus:!0,blur:!0,tap:!0,dbltap:!0,click:!0,dblclick:!0,longpress:!0,wheel:!0,contextmenu:!0,resizestart:!0,resize:!0,resizeend:!0,beforeunload:!0,touchstart:!0,touchmove:!0,touchend:!0},D,A,C,E=null,M=[],H=a.dispatchEvent,K=a.getDispatchPath,P;q.doc=e.ownerDocument;q.t=e;q.enabled=!0;l.tabIndex=0;(q.da=l).style.cssText+="position:relative;width:100%;height:100%;overflow:hidden;outline:none;";
c.Gd("width",l.offsetWidth);c.Gd("height",l.offsetHeight);(q.Df=p).style.cssText+="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";if(ovi.browser.msie)p.style.backgroundColor="white",nokia.maps.dom.Hd(p,0);(q.Yi=m).style.cssText+="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";(q.S=z).style.cssText+="z-index:0;";q.ko=k.Page(z);q.jb=s;for(P in B)f("add",P,b);q.addEvent=function(a){B[a]=!0;return f("add",a,b)};q.removeEvent=function(a){delete B[a];return f("remove",
a,b)};q.containerDestroy=function(){var a=this,c;for(c in B)f("remove",c,b);try{e.removeChild(l)}catch(h){}setTimeout(function(){for(var b in a)a[b]=typeof a[b]=="function"?d.A:null},0)}}})})();ovi.provide("nokia.maps.map.js.copyrights");ovi.provide("nokia.maps.resources.copyrights.json");nokia.maps.resources.copyrights.json='/*\n * Fetched 2010-11-08 from\n * http://maptile.maps.svc.ovi.com/maptiler/v2/copyright/newest?referer=&token=&output=xml&callback_func=BAR&callback_id=FOO\n *\n * Manually correction by Thomas Fischer:\n * - add missing default copyrights (whole world, level 0-20) for "normal" and "hybrid"\n * - fix wrong label for Chineese "normal" map from "NAVTEQ 2010" into "NavInfo 2010"\n * - changed all "2010" to "2011"\n *\n * Update by Michal Aichinger\n * - changed all "2011" to "2012"\n * \n * - change all "2012" to "2013"\n * - all labels should be in form "@ year company", not "@ company year"\n * - replace all Navteq by Nokia\n * - fixed hybrid copyright to not repeat Nokia for zoom levels 9 - 20, hybrid is copyrighted to Nokia and DigitaGlobe in whole space.  \n *\n * Update by Radek\n * - adding C3 Technologies for globe\n * - adding INEGI to terrain since it is in fact terrain hybrid\n * - currently we are loading copyrights from http://maps.nlp.nokia.com/maptile/2.1/copyright/newest and we use this one to updated missing features (or as fallback)\n * \n * Update by J\u00f6rg\n * - changing default copyright to 1987 - 2013 HERE\n * \n * Update by Tomas T.\n * - updating 2013 to 2014\n */\n\n{\n\t"panorama": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 22,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 2014 Nokia All Rights Reserved"\n\t\t}\n\t],\n\t\n\t"globe": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 22,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 2014 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 22,\n\t\t\t"label": "2014 DigitalGlobe",\n\t\t\t"alt": "copyright 2014 DigitalGlobe, Inc."\n\t\t}\n\t],\n\t\n\t"normal": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 8,\n\t\t\t"label": "2014 INEGI",\n\t\t\t"alt": "copyright 2014 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t}\n\t],\n\t"satellite": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t}\n\t],\n\t"hybrid": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 8,\n\t\t\t"label": "2014 INEGI",\n\t\t\t"alt": "copyright 2014 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t}\n\t],\n\t"terrain": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "1987 - 2014 HERE",\n\t\t\t"alt": "copyright 1987 - 2014 HERE All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "SRTM V4, 2014, CIAT",\n\t\t\t"alt": "SRTM V4, 2014, CIAT"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 8,\n\t\t\t"label": "2014 INEGI",\n\t\t\t"alt": "copyright 2014 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t}\n\t]\n}';
(function(){function e(b,c){h(c,function(c,d){a[c]||(a[c]={});b[c]||(b[c]=[]);a[c][d.label]||b[c].unshift(d)})}function k(a,b){var c=b.boxes,d,f;if(c instanceof Array)for(d=c.length;d--;)f=c[d],c[d]=new q([f[2],f[1]],[f[0],f[3]],!0)}function h(a,b){var c,d;for(c in a)if(a.hasOwnProperty(c))for(d=a[c].length;d--;)b(c,a[c][d])}var d=nokia.maps,c=d.Config,g=d.net.Request,b=d.util.getRootNameSpace("nokia.maps").Settings,f=nokia.maps.util.services,q=d.geo.BoundingBox,a={},r=d.resources.copyrights=eval("("+
nokia.maps.resources.copyrights.json+")")||{},l=c.getDefault("copyrights"),d=new ovi.Class({Extends:d.util.OObject,initialize:function(){h(r,k);this.set("copyrights",r);this.onCopyrightLoaded=ovi.bind(this,this.onCopyrightLoaded);this.En={}},loadCopyright:function(a){var d,e;e=b.serviceMode;d=c.getDefault("secureConnection");a=a||"base";!this.En[a]&&l&&(d=d==="force"||d==="prefer"?l.replace("http://","https://"):l,d=d.replace("{serviceMode}",e?"."+e:""),d=d.replace("{service}",a),d=f.addNlpParams(d),
e=new g(g.JSONP,{callbackKey:"callback_func",standardJSONP:!0}),e.send(d,this.onCopyrightLoaded),this.En[a]=!0)},onCopyrightLoaded:function(b){!b.error&&b.response&&(b=ovi.json.parse(b.response),a={},h(b,function(b,c){k(0,c);a[b]||(a[b]={});a[b][c.label]=!0}),e(b,r),r=b,this.set("copyrights",b))},get:function(a,b,c){var d=[],f=this.copyrights,e,g,l,h;switch(a){case "terrain":case "satellite":case "hybrid":e="aerial";break;case "traffic":e="traffic";break;default:e="base"}this.En[e]||this.loadCopyright(e);
if(a=f[a])for(g=a.length;g--;)if(f=a[g],c>=f.minLevel&&c<=f.maxLevel){if(e=f.boxes){h=0;for(l=e.length;l--;)if(e[l].intersects(b)){h=1;break}}else h=1;h&&d.unshift({label:f.label,alt:f.alt})}return d}});nokia.maps.map.js.copyrights=new d})();ovi.provide("nokia.maps.css");
(function(e){var k=e.css,h=e.dom.Page.browser,d=e.dom.Page.platform,d=d.ipad||d.iphone||d.ipod,c=h.gecko?"Moz":h.opera?"O":h.msie?"ms":h.webkit?"Webkit":null,d=2*(h.msie&&h.version>=12||h.gecko&&h.version>=10||d||h.safari)|1*!(h.msie&&h.version<10||h.gecko&&h.version<=4),g={};ovi.extend(k,{transformType:d,cw:c,so:c?"-"+c.toLowerCase()+"-":"",Qr:c==="O"?"oTransitionEnd":c==="Webkit"?"webkitTransitionEnd":c==="MS"?"MSTransitionEnd":"transitionend",getVendorJsProperty:function(b){return g[b]||(g[b]=
c+b.substr(0,1).toUpperCase()+b.substr(1))},css3Style:function(b,d,e){b=b.style;b[d]=e;c&&(b[this.getVendorJsProperty(d)]=e)},cssTransform:function(b,c){this.css3Style(b,"transform",c)},cssTransformOrigin:function(b,c){this.css3Style(b,"transformOrigin",c)},cssTransformStyle:function(b,c){this.css3Style(b,"transformStyle",c)},cssBackfaceVisibility:function(b,c){this.css3Style(b,"backfaceVisibility",c)},supportsTransition:function(){return!h.msie||h.version>=10},applyMatrix:d&2?function(b,c){var d=
c.rows,a=d[0],e=d[1],d=d[2];b.style[k.getVendorJsProperty("transform")]="matrix3d("+a[0]+","+e[0]+","+d[0]+",0,"+a[1]+","+e[1]+","+d[1]+",0,"+a[2]+","+e[2]+","+d[2]+",0,"+a[3]+","+e[3]+","+d[3]+",1)"}:d&1?function(b,c){var d=c.rows,a=d[0],d=d[1];b.style[k.getVendorJsProperty("transform")]="matrix("+a[0]+","+d[0]+","+a[1]+","+d[1]+","+a[3]+","+d[3]+")"}:function(b,c){var d=c.rows,a=b.style;a.top=d[1][3]+"px";a.left=d[0][3]+"px"},translateXYElement:d&2?function(b,c,d){b.style[k.getVendorJsProperty("transform")]=
"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+c+","+d+",0,1)"}:d&1?function(b,c,d){b.style[k.getVendorJsProperty("transform")]="matrix(1,0,0,1,"+c+","+d+")"}:function(b,c,d){b=b.style;b.top=d+"px";b.left=c+"px"},transformElement:d?function(b,c,d,a,g,l){var h=new e.util.Matrix3D,h=h.translate(c,d,0);a&&(h=h.rotateZ(a));g!==void 0&&g!==1&&(h=h.scale(g,l!==void 0?l:g,1));k.applyMatrix(b,h)}:function(b,c,d){b=b.style;b.left=c+"px";b.top=d+"px"}})})(nokia.maps);ovi.provide("nokia.maps.map.Object");
(function(e){if(!e.util.getConstructor(e.map.Object)){var k=0,h=0,d=function(c,b){var d=c.Oa(),e=b.Oa(),a,k,l,m=0,p;if(!d||!e)return 0;a=d.length;k=e.length;for(l=a<k?a:k;m<l;m++)if(p=e[m]-d[m])return h?-p:p;return h?a-k:k-a},c={rev:0,sort:function(c,b,f){var e=[],a,k,l=c.length;for(k=0;k<l;k++)((a=c[k]).getIconForRendering||a.drawToTile)&&(b||a.isVisible())&&e.push(a);h=f;e.sort(d);return e},create:function(c){var b=c.t,d;d=null;b&&(d=(d=b.Oa())?d.slice():[],d.push(c.zIndex,b.objects.indexOf(c)));
return d}};nokia.maps.map.Object=new ovi.Class({Extends:e.util.OObject,Mixins:e.dom.EventTarget,Statics:{sortByZInfo:c.sort,CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4},dispatch:function(c){c.display=this.getDisplay();return e.dom.EventTarget.prototype.dispatch.call(this,c)},initialize:function(c){this.e=new e.map.provider.NullObjectProvider;this.id=k++;c&&"draggable"in c?(c.isDraggable=c.draggable,delete c.draggable,this._super(c),c.draggable=c.isDraggable,delete c.isDraggable):this._super(c);
this.addObserver("*",this.ac,this)},t:null,CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4,isEventTarget:!0,zIndex:0,visibility:!0,u:"object",Nc:function(){return this.Ob||(this.Ob={})},destroy:function(){var c=this.t;c&&c.objects.remove(this);this.removeAllListeners();this.e=null;this.removeObserver("*",this.ac,this)},getInvalidations:function(c){var b=this.Ob;return b?(b[1]>c)*1|(b[2]>c)*2|(b[4]>c)*4:0},ac:function(c,b){this.ia(b,0)},getProvider:function(){return this.e},getParent:function(){return this.t},
getRoot:function(){for(var c=this,b;b=c.t;)c=b;return c},getDisplay:function(){var c=this.getRoot();return c.u==="display"?c:null},isVisible:function(){var c=this,b=!1;do b=c.visibility;while(b&&(c=c.t));return b},ia:function(c,b){var d;d=this.e;var e;b|=c==="zIndex"?4:c==="visibility"?2:0;e=d.rc(this,b);d=this.Nc();b&1&&(d[1]=e);b&2&&(d[2]=e);b&4&&(d[4]=e)},zIndexSetter:function(c){this.Pb();return c},eventListenerSetter:function(c){var b=0,d,e;if(c)for(e in this.removeAllListeners(),c)if((b=ovi.type(d=
c[e]))==="array")for(b=0;b<d.length;b+=3)this.addListenerNS(d[b+2],e,d[b],d[b+1]);else b==="function"&&this.addListenerNS(null,e,d,!1)},Oa:function(){var d;if(!(d=this.pc))d=this.pc=c.create(this);return d},Pb:function(){this.pc=void 0},adopt:function(c){return c.adopt(this)},orphan:function(){return this.e.orphan(this)}})}})(nokia.maps);ovi.provide("nokia.maps.map.Container");
(function(){var e=nokia.maps.map,k=nokia.maps.util,h=k.d,d=new ovi.Class({Extends:e.Object,initialize:function(c,d){c&&!c.length&&(d=c,c=void 0);var b=this,f=b.objects=new k.OList;f.Lu=f.M;f.M=function(c,a,d){c===b&&h();var e=c.e,g=c.t;g&&g.objects.remove(c);if(c.orphan()&&c.adopt(b.e))return c.Pb(),f.Lu(c,a,d);g&&g.objects.add(c);c.e=e;h()};f.Mu=f.cc;f.cc=function(b,a){f.get(b);return this.Mu(b,a)};f.addObserver(b.Ss,b);b._super(d);c&&f.addAll(c)},u:"container",objectsSetter:function(c){this.objects.clear();
return this.objects.addAll(c)},Ss:function(c,d,b,f){var e=this.e,c=c.ha.length;d==="add"?(b.t=this,this.Fp(b)&&this.rj(e.cg,b,[]),f!==c-1&&this.km(f+1)):(this.Fp(b)&&this.rj(e.Wh,b,[]),b.t=null,b.Pb(),f!==c&&this.km(f))},rj:function(c,d,b){var f,e;if(this.Tp(d)){d=d.objects;for(e=d.getLength();e--;)f=d.get(e),f=this.Tp(f)?f.rj(c,f,b):c.apply(this.e,[f].concat(b))}else f=c.apply(this.e,[d].concat(b));return f},Tp:function(c){return c instanceof d},Fp:function(c){for(var d=this.e.jv;c=c.t;)if(c===d)return!0;
return!1},getBoundingBox:function(){for(var c=this.objects,d=c.getLength(),b,f=null;d--;)if(b=c.get(d).getBoundingBox())f=!f?b:f.merge(b);return f},ia:function(c,d){d|=c==="zIndex"?4:c==="visibility"?2:0;d&&this.rj(this.e.rc,this,[d])},km:function(c){for(var d=this.objects.ha,b=d.length;c<b;)d[c++].Pb()},Pb:function(){this._super();this.km(0)},contains:function(c){for(var d=!1;c&&!(d=c===this);)c=c.t;return d},orphan:function(){for(var c=this.objects,d=c.getLength();d--;)c.get(d).orphan();return this._super()},
adopt:function(c){for(var d=this.objects,b=d.getLength();b--;)d.get(b).adopt(c);return this._super(c)}});if(e.Container.isNs)e.Container=d})();ovi.provide("nokia.maps.map.provider.ImageProvider");
(function(){function e(e,d,c){this.id=e;this.provider=c;this.bbox=d}var k=nokia.maps.dom.imgLoader;ovi.extend(e.prototype,{send:function(e){var d=this;this.state=k.request(this.data=new Image,this.id,function(c,g){d.state=g;e(d)})},abort:function(){k.cancel(this.data)}});nokia.maps.map.provider.ImageProvider=new ovi.Class({Extends:nokia.maps.map.provider.BitmapProvider,initialize:function(e){this._super(e)},create:function(h,d){return new e(h,d,this)},getId:function(){return this.getUrl()},getInvalidations:function(e){return(e<
this.getInvalidationMark())*1}});nokia.maps.map.provider.ImageProvider.Request=e})();ovi.provide("nokia.maps.map.render.p2d.TileLayer");
(function(){var e=Math,k=e.abs,h=e.round,d=e.floor,c=e.log,g=e.LN2,b=e.pow;new Image;var e=nokia.maps,f=e.util,q=f.Point,a=f.vf,r=e.dom,l=e.gfx.Painter.defaultPainter,m=nokia.maps.map.render.p2d.TileLayer=new ovi.Class({initialize:function(a,b,c,d){this.Fd=b.opacity||1;this.o=a;this.e=b;this.Da=d;this.C=a.ownerDocument;this.Yb={};this.xc={};this.kk=0;this.Ae=new l;this.nd=new q(-1,-1);b.addListener("response",this.ra=ovi.bind(this,this.ra))},Statics:{Vl:function(a,b){return h(c(b.w/a.width)/g)},Ap:function(a,
c,d){isNaN(d)&&(d=m.Vl(a,c));return new q(c.w/(b(2,d)*a.width),c.h/(b(2,d)*a.height))},Os:function(b,c,f,e,g,l,r,y,B,D){var A,C,E,M,H,r=[],B=isNaN(B)?m.Vl(b,c):h(B);if(b.providesLevel(B)){y=y.sub(e);l=b.jc;D=D||m.Ap(b,c,B);c=new q(l.x*D.x,l.y*D.y);if(c.x%1||c.y%1)c=c.round(),D.x=c.x/l.x,D.y=c.y/l.y;c=b.pixelProjections[B];g=new q(g.x*c.w-e.x/D.x,g.y*c.h-e.y/D.y);c=new q(a(g.x,l.x),a(g.y,l.y));g=g.sub(c).round();A=(new q(c.x*-D.x,c.y*-D.y)).sub(e).round();c=(new q(l.x*D.x,l.y*D.y)).round();D=c.divide(2);
f=f.sub(e);e=d(g.y/l.y);for(C=A.y;C<f.y;C+=c.y){E=d(g.x/l.x);for(M=A.x;M<f.x;M+=c.x)(H=b.createId(B,e,E))&&r.push({Vf:M,Wf:C,c:H,tc:B,ir:e,Ro:E++,Oq:k(y.x-(M+D.x))+k(y.y-(C+D.y))});e++}}return r}},sc:-1/0,hh:-1/0,ih:-1/0,Tc:0,Xh:-1,xh:function(){this.Da(this,this.vm>0)},sa:e.util.A,stop:function(a,b){var c=this.xc,d,f=this.e;if(this.kk)for(d in c)c[d]&&(f.cancel(d),this.ra({data:[d]}));this.xc=a||{};this.kk=b||0},shutdown:function(){this.Da=f.A;this.e.removeListener("response",this.ra);this.Yb={};
r.bc(this.o);this.stop();return this.o},ra:function(){throw Error("_onProviderResponse needs implementation");},Qq:function(a,b,c){var d=0,f=a[b]||(d=1,a[b]=[]);c?f.push(c):a[b]=0;return d},Su:function(a,b){var c=a[b];return c&&(c.length<2?(a[b]=0,c[0]):c.pop())},Ft:function(a,b){var c=a[b];return c&&c[0]},sn:function(a,b){var c=a[b],d;if(c&&a.hasOwnProperty(b)){for(d=c.length;d--;)this.rn(c[d]);a[b]=0}},Ee:function(a,b,c){this.Qq(c,a,b)},Ui:function(a,b){b||(b={c:a.c});b.tc=a.tc;b.sb=a.sb;return b},
Gv:function(a,b){return b.Oq-a.Oq},render:function(a,b,c,d,f,e,g,l,k,q,r,C,E,M){var a=this.e,d=m.Ap(a,c,r=isNaN(r)?m.Vl(a,c):r),b=m.Os(this.e,c,f,e,b,k,q,E,r,d),c=b.length,H,f=this.Yb,k={},q=this.xc,E={},g=0,l=a.getInvalidationMark(),K,P=0,F=a.strictInvalid,L=this.Fd;this.Xh=r;this.nd.x=h(a.jc.x*d.x);this.nd.y=h(a.jc.y*d.y);this.Wc=e;for(C||b.sort(this.Gv);c--;){K=!1;e=b[c];H=e.c;r=this.Su(f,H);if(!r&&(r=this.Ft(k,H)))K=1;if(!r||!K&&a.getInvalidations(r.sb,this.sc))if(q[H]?(q[H]=0,d=!0):d=E[H]?!0:
a.request(e.tc,e.ir,e.Ro,C),d===!0?(++P,g+=this.Qq(E,H,e)):d?(e.sb=d,e.Ca=this.mk(d.getNode(this.C)),this.Ee(H,e,k,L)):++P,r&&(F||d!==!0&&(!C||d!==!1)))this.rn(r),K||this.sn(f,H),r=0;if(r)K&&(r=this.Ui(r)),r.Vf=e.Vf,r.Wf=e.Wf,this.Ee(H,r,k,L)}this.hh=M;if(!C)this.sc=l,this.ih=M;this.stop(E,g);for(H in f)this.sn(f,H);this.Yb=k;this.vm=P;C||g||this.xh();return!g&&!P},capture:function(a,b,c){var d=this.Wc,f,e;e=this.e;var g=e.width,l=e.height,h=this.Yb,k,m;b-=d.x;c-=d.y;a.save();a.set("opacity",e.opacity);
for(f in h){d=h[f];for(k=d.length;k--;)e=d[k],m=e.Ca,a.drawImage(m.firstChild||m,0,0,g,l,e.Vf-b,e.Wf-c,g,l)}a.restore()}})})();ovi.provide("nokia.maps.map.render.p2d.MarkerLayer");
(function(e){function k(a){this.vc=a}function h(a){var b=a.parentNode;return l||b&&b.nodeType!==11?r.cloneNode(a,!0):a}var d=[],c=e.util,g=e.map.provider,b=e.map.render.p2d._helpers.geoToScreen,f=c.Point,q=c.Rectangle,a=e.gfx,r=e.dom,l=a.Painter.defaultPainter.isVML;k.prototype.getObject=function(){return this.vc};nokia.maps.map.render.p2d.MarkerLayer=new ovi.Class({initialize:function(a,b,c,d){this.o=a;this.C=a.ownerDocument;this.e=b;this.mm=b instanceof g.LocalObjectProvider;this.pe={};this.Kp=
[];this.Mo=new e.util.Cache(128);this.Da=d;this.hq=300;this.e.addListener("response",this.ra=ovi.bind(this,this.ra))},Tc:0,ra:function(a){var c,d,f,e,g,l,h,k,r,q;if(a.data[0]===this.Cf){c=this.Mo;f=this.C;l={};r=this.Aj;q=this.Wc;g=this.Zp;h=a.data[1];for(k=h.length;k--;)e=h[k].getObject(!0),a=e.getIconForRendering(f),d=a.createElement(),d.style.position="absolute",c.add(a.c,d),l[e.id]=[e,this.Yl(e,g,r,q,a),d],this.dn(a,d,b(e.coordinate,g).sub(e.anchor),k,!0);this.qn();this.Cf=!1;this.pe=l}},sa:e.util.A,
zb:function(a,b,c){for(var e=this.pe,g=this.Kp,l,h,k=g.length,r,q;k--;)if(h=g[k],l=e[h])if(h=l[1],h.contains(new f(a,b))&&(h=h.topLeft,l=l[0],r=l.hitArea,!r||r.hitTest(a-h.x,b-h.y)))if(q||(q=[]),q.push(l),c)break;return q||d},stop:function(){if(this.Cf)this.e.cancelBBoxRequest(this.$p.bBox,2,this.$p.zoom),this.Cf=!1},shutdown:function(){this.Da=c.A;this.e.removeListener("response",this.ra);this.stop();this.pe={};r.bc(this.o);return this.o},sc:-1/0,hh:-1/0,ih:-1/0,render:function(a,c,d,f,e,g,l,r,q,
B,D,A,C,E){var f=this.e,e=f.getInvalidationMark(),r=this.sc,M,H,K,P,F,L,ea,U,aa,la=0,J,a=Math.round(Math.log(d.w/f.width)/Math.LN2),D=this.o,C=this.pe;M={};H=this.Kp;ea=this.Mo;U=this.C;aa=!A;J=this.mm;this.Zp=d;this.Aj=c;this.Wc=g;this.Cf&&!A&&this.stop();if(A&&this.cq!==a){q=[];for(B=H.length;B--;)K=C[H[B]][0],q.push(J?K:new k(K))}else q=f.requestBBox(l,2,a,A);B=q.length;H.length=0;if(!this.Cf&&!A)this.Cf=q===!0?f.jj(l,a):!1,this.$p={bBox:l,zoom:a};for(;B--;){if((K=J?q[B]:q[B].getObject(!0))&&K!==
!0){l=0;P=K.id;a=C[P];L=b(K.coordinate,d).sub(K.anchor);a&&(F=a[2])?f.getInvalidations(K,r)?l=K.getIconForRendering(U):A||ea.get(K.getIconForRendering(U).c):(F=ea.get(K.getIconForRendering(U).c,A))?F=h(F):A||(l=K.getIconForRendering(U));if(l)F=l.createElement(),F.style.position="absolute",ea.add(l.c,F),F=h(F),a&&(this.pn(D,a[2]),a[2]=F);F&&(l||(l=K.getIconForRendering(U)),a?(a[1]=this.Yl(K,d,c,g,l),C[P]=0,M[P]=a):M[P]=[K,this.Yl(K,d,c,g,l),F],H.push(P),this.dn(l,F,L,B,!1))}if(A&&la===this.hq){aa=
!1;break}la++}this.qn();this.hh=E;if(!A)this.sc=e,this.ih=E;this.pe=M;this.Da(this,!1);return aa},Yl:function(a,c,d,e,g){a=b(a.coordinate,c).sub(a.anchor);return new q([a,new f(a.x+g.width,a.y+g.height)])},uw:function(a,b,c,d,e){var g=new f(b,c);return a.contains(g)&&(!d||d.hitTest(b-bbox.topLeft.x,c-bbox.topLeft.y,e))},capture:function(c,d,f){var e=this.Zp,g,l=this.pe,h=this.Wc,k,r,q;d-=h.x;f-=h.y;for(g in l)h=l[g][0],k=h.icon,r=b(h.coordinate,e).sub(h.anchor),q=r.x-d,r=r.y-f,h.icon.isBitmap?c.drawImage(k.Ab,
0,0,k.width,k.height,q,r,k.width,k.height):c.drawGraphics(new a.Graphics(k.getIDL()),0,0,k.width,k.height,q,r,k.width,k.height)}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.MarkerLayer");
(function(){var e=nokia.maps,k=e.css,h=Math.round;e.map.render.p2d.dom.MarkerLayer=new ovi.Class({Extends:e.map.render.p2d.MarkerLayer,initialize:function(d,c,e){this._super.apply(this,arguments);this.hq=1E4;d.className=e.cssClass+"_markerLayer"},dn:function(d,c,e,b){d=this.o;k.translateXYElement(c,h(e.x),h(e.y));c.style.zIndex=-b;c.parentNode!==d&&d.appendChild(c)},show:function(){if(this.Tc)this.o.style.display="",this.Tc=0},hide:function(){if(!this.Tc)this.o.style.display="none",this.Tc=!0},qn:function(){var d=
this.o,c=this.pe,e,b;if(d.childNodes.length)for(b in c)(e=c[b])&&this.pn(d,e[2])},pn:function(d,c){d.removeChild(c)}})})();ovi.provide("nokia.maps.map.render.p2d.canvas.TileLayer");
(function(){var e=Math.round,k=nokia.maps.util.A;nokia.maps.map.render.p2d.canvas.TileLayer=new ovi.Class({Extends:nokia.maps.map.render.p2d.TileLayer,initialize:function(e,d,c,g){this._super(e,d,c,g);this.useBuffer=c.useBuffer;this.Ud=e.getContext("2d");this.wb=this.tl();this.vd=this.wb.getContext("2d");if(this.useBuffer)this.Yn=this.tl(),this.Er=this.Yn.getContext("2d"),this.dg=this.tl(!0),this.Li=this.dg.getContext("2d")},tl:function(){var e=this.C.createElement("canvas");e.width=this.o.width;
e.height=this.o.height;return e},sa:function(){var e=this.o,d=e.width,e=e.height;this.Vk(this.wb,d,e);this.useBuffer&&(this.Vk(this.Yn,d,e),this.Vk(this.dg,d,e))},Vk:function(e,d,c){e.width=d;e.height=c},ra:function(e){var d=e.data,e=d[0],d=d[1],c=this.xc,g=c[e],b,f=0,k,a=this.Fd;if(g){if(d)for(k=g.length;f<k;)(b=g[f]).sb=d,b.Ca=d.getNode(this.C),this.Ee(e,b,this.Yb,a),f++,--this.vm;c[e]=0;--this.kk||this.xh()}},Ee:function(e,d,c,g){var b=this.vd,f=d.Ca;if(g!==1)b.save(),b.globalAlpha=g;(f.nodeName!==
"IMG"||f.complete&&f.naturalWidth)&&b.drawImage(d.Ca,d.Vf+this.Wc.x,d.Wf+this.Wc.y,this.nd.x,this.nd.y);g!==1&&b.restore();this._super(e,d,c,g)},render:function(h,d,c,g,b,f,k,a,r,l,m,p,z,s){var v=!1,u,x,w=b.x||1;u=(b.x+g[3]-g[1])/2;var y=b.y||1;x=(b.y+g[0]-g[2])/2;p&&this.useBuffer?this.hh!==s?(h=c.w/this.gu,d=c.w,u=(this.Bj-u)*h-(c.x-u),u=e(u+(u>d/2?-d:u<-d/2?d:0)),x=-e(c.y-x-(this.qm-x)*h),this.Er.clearRect(0,0,w,y),this.Er.drawImage(this.dg,0,0),this.Li.clearRect(0,0,w,y),this.Li.drawImage(this.Yn,
0,0,w,y,u,x,w*h,y*h),this.Ud.drawImage(this.dg,0,0)):this.Ud.drawImage(this.wb,0,0):(this.ih===s&&this.sc===this.e.getInvalidationMark()?(v=!0,this.xh()):(this.vd.clearRect(0,0,w,y),this.useBuffer&&this.vd.drawImage(this.dg,0,0),v=this._super.call(this,h,d,c,g,b,f,k,a,r,l,m,p,z,s)),this.useBuffer&&(this.Li.clearRect(0,0,w,y),this.Li.drawImage(this.wb,0,0)),this.Ud.drawImage(this.wb,0,0));this.Bj=c.x;this.qm=c.y;this.gu=c.w;return v},Ui:function(e,d){d=this._super(e,d);d.Ca=e.Ca;return d},mk:function(e){return e},
rn:k,show:k,hide:k})})();ovi.provide("nokia.maps.map.render.p2d.canvas.MarkerLayer");
(function(){var e=nokia.maps,k=e.util.A,h=Math.round,d=Math.min;e.map.render.p2d.canvas.MarkerLayer=new ovi.Class({Extends:e.map.render.p2d.MarkerLayer,initialize:function(c){this._super.apply(this,arguments);this.Ud=this.o.getContext("2d");this.wb=this.C.createElement("canvas");this.wb.width=c.width;this.wb.height=c.height;this.vd=this.wb.getContext("2d");this.Jl=this.Il=0},sa:function(){var c=this.o,d=this.wb;this.Uf=d.width=c.width;this.nf=d.height=c.height},dn:function(c,e,b,f,k){if(!k){var f=
e,a,r,l;if(e.nodeName==="DIV"&&(f=e.firstChild))a=c.offsetX!==void 0;f&&(e=h(b.x+this.Wc.x),b=h(b.y+this.Wc.y),a?this.vd.drawImage(f,c.offsetX,c.offsetY,r=d(c.width,c.naturalWidth-c.offsetX),l=d(c.height,c.naturalHeight-c.offsetY),e,b,r,l):this.vd.drawImage(f,e,b,c.width,c.height))}},shutdown:function(){this._super();this.wb=void 0},show:k,hide:k,qn:k,pn:k,render:function(c,d,b,f,e,a,h,l,k,p,z,s,v,u){var x=!1;s?this.hh!==u&&(this.cq===c&&this.Bj!==void 0?(this.Il+=b.x-this.Bj,this.Jl+=b.y-this.qm):
(this.vd.clearRect(0,0,this.Uf,this.nf),x=this._super(c,d,b,f,e,a,h,l,k,p,z,s,v,u))):this.ih===u&&this.sc===this.e.getInvalidationMark()?(this.Da(this,!1),x=!0):(this.vd.clearRect(0,0,this.Uf,this.nf),x=this._super(c,d,b,f,e,a,h,l,k,p,z,s,v,u),this.Jl=this.Il=0);this.Ud.drawImage(this.wb,0-this.Il,0-this.Jl);this.Bj=b.x;this.qm=b.y;this.cq=c;return x}})})();ovi.provide("nokia.maps.map.render.p2d.canvas.SpatialTileLayer");
(function(){var e=[],k=Math.pow,h=nokia.maps.map,d=h.Object.sortByZInfo,h=h.render.p2d.canvas,c=h.TileLayer;h.SpatialTileLayer=function(g,b,f,h){g=new c(g,b,f,h);g.zb=function(a,b,c){var f=this.e,g=k(2,this.Xh+8);a*=g;var b=b*g/this.nd.x*this.nd.y,g=f.getTileId(this.Xh,a,b),h,q;if(g&&(h=this.Yb[g])&&(h=h[0]))q=d(h.sb.zb(a%f.width,b%f.height,c),!1,!1);return q||e};return g}})();ovi.provide("nokia.maps.map._Copyright");ovi.provide("nokia.maps.resources.copyright.html");
nokia.maps.resources.copyright.html='<div class="nm_crimg" style="display:block;position:absolute;bottom:20px;left:4px;width:33px;height:24px;margin:6px;cursor:pointer" title="HERE"></div> \r\n<div class="nm_crnode" style="position:relative;top:0;padding-left:10px;padding-bottom:8px;height:13px;font-size:10px;font-family:arial, sans-serif;color:#333;white-space:nowrap;"> \r\n\t<span class="nm_crtext"></span>&nbsp;<a class="nm_toulink" target="_blank" style="text-decoration: underline;"></a>\r\n\t&nbsp;<a class="nm_rilink" target="_blank" title="" style="text-decoration: none;"></a>\r\n</div>';
(function(e){function k(b){a.test(b)||e.util.d("alignment '"+b+"'");this.Xi.po(b);return b}var h=e.dom,d=Math.floor,c=e.util,g=new e.language.Manager,b=c.Point,f=new Image,q=e.loadPath+e.config.assetsPath+"/here_logo.png",a=/^(top|middle|bottom)(left|center|right)$/,r;f.src=q;e.map.yo=new ovi.Class({initialize:function(a){var b,d;this.ga=a;r=ovi.Array([a.SATELLITE,a.SATELLITE_PLAIN,a.SATELLITE_COMMUNITY,a.GLOBE,a.PANORAMA]);b=this.Vo=h.hb(a.Yi,"div");b.innerHTML=e.resources.copyright.html;this.ho=
h.findElement("nm_toulink",b);d=this.bi=h.findElement("nm_rilink",b);d.onclick=function(){var b=a.m.getCam(),c="http://here.com/latitude,longitude,fov,yaw,pitch,panorama.day,report",d;for(d in b)c=c.replace(RegExp("\\b"+d+"\\b"),b[d]);this.href=c};d.onclick();this.Gr=(this.Nv=h.findElement("nm_crtext",b)).parentNode;(d=(this.dm=b=h.findElement("nm_crimg",b)).style).backgroundRepeat="no-repeat";d.backgroundImage="url("+q+")";b.onclick=function(){var b=a.center;window.open(["http://here.com/?cid=nokiamaps-fw-ilc-na-acq-na-thirdparty-g0-na-1#",
b.latitude,b.longitude,a.zoomLevel,"0|0|"].join("|"))};a.Gd("poweredByWidth",b.offsetWidth);a.Gd("poweredByHeight",b.offsetHeight);this.Ff=ovi.bind(this,this.Ff);a.copyrightAlignmentSetter=k;a.addListener("basemapchangeend",this.Ff);a.addListener("mapviewchangeend",this.Ff);a.addListener("resizeend",this.Ff);e.map.js.copyrights.addObserver("copyrights",this.Ff);this.po(a.copyrightAlignment);this.sq();c.getRootNameSpace("nokia.maps").Settings.addObserver("defaultLanguage",this.sq,this)},sq:function(){var a;
a=this.ho;a.title=a.innerHTML=g.translateToken("ovi.service.map._t66",!1);a.href=h.Page.browser.mobile?"http://nokia.mobi/terms":g.translateToken("ovi.service.map._t67",!1);a=this.bi;a.title=a.innerHTML=g.translateToken("ovi.service.map._t94",!1);this.bi.style.display="none"},po:function(c){var f=this.ga,e=this.Vo,g=this.Gr,h=this.dm;if(c){var k=a.exec(c),c=k[1],k=k[2],r=e.style;r.cssText="position:absolute;z-index:500;"+(c==="middle"?"top:50%;margin-top:"+d(e.offsetHeight/-2)+"px;":c+":"+(c==="top"?
"34px;":"-7px;"))+(k==="center"?"left:50%;margin-left:"+d(e.offsetWidth/-2)+"px;":k+":"+(k==="left"?"-4px;":"4px;"))+"width:"+r.width+";height:"+r.height+";"}if(e.style.bottom&&ovi.dom.hasClass(f.S.parentNode,"nm_adbar_bottom"))e.style.bottom="21px";e=new b(e.offsetLeft,e.offsetTop);f.Gd("copyrightPosition",e.add({x:g.offsetLeft,y:g.offsetTop}));f.Gd("poweredByPosition",e.add({x:h.offsetLeft,y:h.offsetTop}))},Ff:function(){var a=this.ga,b=a.baseMapType,c=this.Gr;this.Nv.innerHTML="&copy; "+a.getCopyright();
r.indexOf(b)===-1?(c.style.color=this.ho.style.color=this.bi.style.color="#333",this.dm.style.backgroundPosition="0 0"):(c.style.color=this.ho.style.color=this.bi.style.color="#FFF",this.dm.style.backgroundPosition="0px -34px");this.bi.style.display=b===a.PANORAMA?"":"none";this.po();a.Gd("copyrightWidth",c.offsetWidth);a.Gd("copyrightHeight",c.offsetHeight)},getCopyrightGfx:function(){var a=this.Vo,b=f.width;return(new e.gfx.Graphics).beginImage(a.offsetWidth+b,a.offsetHeight+34-6).drawImage(f,0,
this.Ep()?34:0,b,34,6,3,b,34).set("fillColor",this.Ep()?"#fff":"#333").fillText(String.fromCharCode(169)+" "+this.ga.getCopyright(),6,40)},Ep:function(){var a=this.ga,b=a.baseMapType;return b===a.SATELLITE||b===a.SATELLITE_PLAIN||b===a.SATELLITE_COMMUNITY||b===a.GLOBE}})})(nokia.maps);ovi.provide("nokia.maps.map.Spatial");nokia.maps.map.Spatial=new ovi.Class({Extends:nokia.maps.map.Object,initialize:function(e){this._super(e);this.Ym={}},simplify:3,Uc:1});ovi.provide("nokia.maps.map.provider.LocalObjectProvider");
(function(e){var k=Math,h=e.util,d=h.Event,c=h.d,g=e.geo.QuadTree,b=e.map.Object,f=b.sortByZInfo,q=b.CHANGE_SPATIAL,a=b.CHANGE_VISUAL,r=b.CHANGE_ZINDEX,l=e.map.provider.LocalObjectProvider=new ovi.Class({Extends:e.map.provider.Provider,Statics:{SPATIAL:1,MARKER:2},initialize:function(a,b){this.um=new g(18);this.Pn=new g(18);this.jv=a.e.orphan(a)&&this.adopt(a);this._super(b)},Qp:-k.pow(2,53),Pp:-k.pow(2,53),Si:function(a){return a?++this.Qp:++this.Pp},getInvalidationMark:function(a){return a?this.Qp:
this.Pp},lo:function(){this.dispatch(new d("update"))},Bo:function(b){var c,d=b.Nc();c=b.Uc?this.Pn.insertBoundingBox(b.getBoundingBox()):this.um.insertCoordinate(b.coordinate);c.fq=b;b.wi=c;d[q]=d[a]=d[r]=this.Si(b.Uc);return b},Xq:function(a){a.Uc?this.Pn.remove(a.wi):this.um.remove(a.wi);a.wi=null;return a},Wh:function(a){a.e!==this&&c();if(!a.wi)return this.getInvalidationMark(a.Uc);this.Xq(a);this.update();this.jp(a);return this.Si(a.Uc)},cg:function(a){a.e!==this&&c();this.Bo(a);this.update();
return this.Si(a.Uc)},rc:function(a,b){a.e!==this&&c();if(!a.wi)return this.getInvalidationMark(a.Uc);b&q&&(this.Xq(a),this.Bo(a));this.jp(a);this.update();return this.Si(a.Uc)},jp:function(a){var b,c;if(a.Uc)for(c in b=a.Ym,b)b[c].hp(a)},getInvalidations:function(a,b){return a.getInvalidations(b)},requestBBox:function(a,b){var c,d,e=[],b=b||l.SPATIAL|l.MARKER;if(b&l.SPATIAL){c=this.Pn.intersectBoundingBox(a,1);for(d=c.length;d--;)e.push(c[d].fq)}if(b&l.MARKER){c=this.um.intersectBoundingBox(a,1);
for(d=c.length;d--;)e.push(c[d].fq)}return e=f(e)},cancelBBoxRequest:function(){},adopt:function(a){if(a.e||!(a instanceof b))return!1;a.e=this;return a},orphan:function(a){if(a.e!==this||!(a instanceof b))return!1;a.e=null;return a}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.TileLayer");
(function(){new Image;var e=ovi.browser.msie,k=nokia.maps,h=k.dom,d=k.css,c=h.cloneNode;nokia.maps.map.render.p2d.dom.TileLayer=new ovi.Class({Extends:k.map.render.p2d.TileLayer,initialize:function(c,b,d){c.style.position="absolute";this.Qv=d.cssClass+"Tile";this._super.apply(this,arguments)},xh:function(){var c,b,f;if(d.supportsTransition()){c=this.o.children;b=c.length;for(f=this.Fd;b--;)this.Rr(c[b],f)}this._super()},ra:function(c){var b=c.data,c=b[0],b=b[1],f=this.xc,e=f[c],a,h=0,l,k,p=this.Fd;
this.sn(this.Yb,c);if(e){if(b)for(l=e.length;h<l;)(a=e[h]).sb=b,(a.Ca=k=this.mk(b.getNode(this.C),h++)).style.position="absolute",d.supportsTransition()?(this.Ee(c,a,this.Yb,0),this.Rr(k,p)):this.Ee(c,a,this.Yb,p),--this.vm;f[c]=0;--this.kk||this.xh()}},Rr:function(c,b){setTimeout(function(){h.Hd(c,b)},20)},rn:function(c){var b=c.Ca;this.o.removeChild(b);c=this.e.request(c.tc,c.ir,c.Ro,!0);(!c||c===!0)&&b.removeAttribute&&b.removeAttribute("src")},Ee:function(c,b,f,e){var a=b.Ca,h=this.nd;d.translateXYElement(a,
b.Vf,b.Wf);this.rr(h.x,h.y,b);this.qr(a,e);a.parentNode!==this.o&&this.o.appendChild(a);this._super(c,b,f,e);this.e.providesLevel(b.tc)&&this.show()},qr:function(c,b){b!==1&&h.Hd(c,b)},rr:function(c,b,d){d=d.Ca.style;d.width=c+"px";d.height=b+"px"},mk:function(d,b){var f=d.parentNode;if(f&&(!e||f.nodeType!==11)&&(b||f!==this.o))d=c(d,!0);d.className=this.Qv;d.style.position="absolute";return d},Ui:function(c,b){b=this._super(c,b);b.Ca=this.mk(c.Ca,!0);return b},show:function(){if(this.Tc)this.o.style.display=
"",this.Tc=!1},hide:function(){if(!this.Tc)this.o.style.display="none",this.Tc=!0}})})();ovi.provide("nokia.maps.map.render.p2d.dom.SpatialTileLayer");
(function(){var e=[],k=Math.pow,h=nokia.maps,d=h.css,c=h.dom,g=h.map,b=g.Object.sortByZInfo,g=g.render.p2d.dom,f=g.TileLayer;g.SpatialTileLayer=function(g,a,r,l){a=new f(g,a,r,l);a.zb=function(a,c,d){var f=this.e,g=k(2,this.Xh+8);a*=g;var c=c*g/this.nd.x*this.nd.y,g=f.getTileId(this.Xh,a,c),l,h;if(g&&(l=this.Yb[g])&&(l=l[0]))h=b(l.sb.zb(a%f.width,c%f.height,d),!1,!1);return h||e};a.Iw=null;g.className=a.qw=r.cssClass+"SpatialTileLayer";a.rr=function(a,b,c){a=new nokia.maps.util.Point(a/c.sb.e.tileSize.x,
b/c.sb.e.tileSize.y);this.Ae.setScale(c.Ca,a)};a.qr=function(a,b){d.transformType>0&&b!==1&&c.Hd(a,b)};a.Ui=function(a,b){b||(b={c:a.c});b.tc=a.tc;b.sb=a.sb;b.Ca=c.cloneNode(a.Ca,!0);b.Ca=b.sb.getNode(this.C);return b};a.capture=function(a,b,c){var d,f,e;f=this.e;var g=f.width,l=f.height,k=this.Yb,r=this.Wc;for(d in k)for(e=k[d].length;e--;)f=k[d][e],a.drawGraphics(new h.gfx.Graphics(f.sb.getIDL()),0,0,g,l,f.Vf+(r.x-b),f.Wf+(r.y-c),g,l)};return a}})();ovi.provide("nokia.maps.map.render.p2d.canvas.MapLayer");
(function(){var e=Math.round,k=Math.max,h=nokia.maps.map.render.p2d.canvas;h.MapLayer=new ovi.Class({initialize:function(d,c,e,b){this.uf=c.min;this.Ya=c.max;this.e=c;this.Da=b;this.t=d;this.cl=new h.TileLayer(d,c,e,function(){});e.useBuffer=!1;this.Cj=new h.TileLayer(d,c,e,this.Da);this.Cb=ovi.bind(this,this.Cb)},shutdown:function(){this.cl.shutdown();this.Cj.shutdown();return this.o},sa:function(){this.cl.sa();this.Cj.sa()},stop:function(){this.Cj.stop()},render:function(d,c,g,b,f,h,a,r,l,m,p,z,
s,v){var u,p=e(p);for(u=k(this.uf,p-3);u<p;)this.cl.render(d,c,g,b,f,h,a,r,l,m,u++,!0,s,v);return this.Cj.render(d,c,g,b,f,h,a,r,l,m,p,z,s,v)}})})();ovi.provide("nokia.maps.map._MarkerIcon");
(function(){function e(c){return new b(typeof c==="object"?c.strokeColor?{strokeColor:a(c.strokeColor)}:void 0:{strokeColor:c})}var k=nokia.maps,h=k.map.HitArea,d=k.util,c=d.proto,g=d.Point,b=d.Pen,f=new b({strokeColor:"#FFF"}),q=d.Brush,a=d.ColorHelper.getHex3,r=k.gfx,l=r.GraphicsImage,m=r.IDL,p=r.Color.parseCss,z=[4207599104,4207599105,4207599106,"$Text$"],s=new k.gfx.SvgParser,v=d.$c("shape text textPen pen brush effect"),u=d.flatMerge(d.$c("anchor hitArea"),v),x=new d.Cache(50),w=nokia.maps.map.Hb=
new ovi.Class({Extends:nokia.maps.util.OObject,initialize:function(a){var b;a&&a.shape&&a.shape!==this.shape?(this.shape=this.shapeSetter(b=a.shape),delete a.shape,this._super(a),a.shape=b):(this.shapeSetter(this.shape),this._super(a));this.addObserver("*",this.ee)},Statics:{kn:u,Ta:function(a){return a in u},te:function(a){return!(a in v)},fc:{balloon:['<path style="opacity:0.4;fill:#353535" d="m 19,31 c 0,1.67 -2.69,3 -6,3 c -3.31,0 -6,-1.33 -6,-3 c 0,-1.67 2.69,-3 6,-3 c 3.31,0 6,1.33 6,3 z" /><path style="fill:#Facade01" d="m 13,0 c -3.47,0 -6.73,1.32 -9.19,3.75 C 1.36,7.82 0,9.41 0,12.84 c 0,3.43 1.36,6.64 3.81,9.06 L 13,31 l 9.19,-9.094 c 2.46,-2.43 3.81,-5.63 3.81,-9.06 c 0,-3.43 -1.36,-6.67 -3.81,-9.09 C 19.73,1.32 16.47,0 13,0 z"/><path style="fill:#ffffff" d="m 13,1 c -3.21,0 -6.23,1.23 -8.5,3.47 c -2.26,2.24 -3.5,5.22 -3.5,8.38 c 0,3.16 1.24,6.14 3.5,8.38 l 8.5,8.38 l 8.5,-8.38 c 2.26,-2.24 3.5,-5.22 3.5,-8.38 c 0,-3.16 -1.24,-6.14 -3.5,-8.38 C 19.23,2.23 16.2,1 13,1 z"/><path style="fill:#Facade00;fill-opacity:1" d="m 13,2.19 c -7,0 -10.74,4.96 -10.81,10.65 c 0,3.27 0.95,5.61 3.03,7.66 l 7.79,7.69 l 7.79,-7.69 c 2.07,-2.05 3.02,-4.27 3.03,-7.66 C 23.58,7.07 19.98,2.19 13,2.19 z"/><text x="13" y="18" font-size="10pt" font-family="arial" font-weight="bold" text-anchor="middle" fill="#Facade02">$Text$</text>',
28,36,13,31,"poly",[0,16,0,7,8,0,18,0,26,7,26,16,18,34,8,34]]}},text:"",pen:c({},f),textPen:c({},f),brush:c({},new q({color:"#1080DD"})),shape:"balloon",effect:"none",ee:function(a,b){if(b in v)a.c="",a.Pa=0},shapeSetter:function(a){var b=w.fc[a]||d.d("shape");this.f=new g(b[1],b[2]);this.anchor=new g(b[3],b[4]);this.hitArea=b[5]?new h(b[5],b[6]):void 0;return a},brushSetter:function(b){return new q(typeof b==="object"?b.color?{color:a(b.color)}:void 0:{color:b})},penSetter:e,textPenSetter:e,textSetter:function(a){return d.sanitizeText(a)},
be:function(){var a=w.fc[this.shape],b,c,d,f;if(a&&typeof a[0]==="string"){b=z.length;for(c=a[0]=ovi.Array(s.parseSvg('<svg version="1.1" width="'+(d=a[1])+'" height="'+(f=a[2])+'" viewBox="0 0 '+d+" "+f+'">'+a[0]+"</svg>").data);b--;){f=[];for(d=-1;(d=c.indexOf(z[b],d+1))!==-1;)f.push(d);f.length&&(a[7+b]=f)}}return a},Je:function(a){for(var b=[p(this.brush.color,1),p(this.pen.strokeColor,1),p(this.textPen.strokeColor,1),this.text],c=b.length,d=a[0].slice(),f,e;c--;)if(f=a[7+c])for(e=f.length;e--;)d[f[e]]=
b[c];return d},getIcon:function(){var a,b;if(!this.Pa){if(!(b=x.get(a=this.ea())))x.add(a,b=new l(new m(this.Je(this.be()))));this.Pa=b}return this.Pa},ea:function(){return this.c||(this.c=(this.hasOwnProperty("shape")?this.shape:"").concat(this.text,this.textPen.ea(),"P",this.pen.ea(),"B",this.brush.ea()))}})})();ovi.provide("nokia.maps.map.Polyline");
(function(e){var k=nokia.maps.geo,h=k.BoundingBox,d=k.Coordinate,e=nokia.maps.util,c=e.math.clipping.clipStrips,g=e.isArray,b=e.Strip,f=nokia.maps.util.Rectangle,q=e.Point,a=e.Arrows,r=e.Pen,l=nokia.maps.gfx.Color.parseCss,m=l("#0000"),p=new b(["latitude","longitude","altitude"]),z=k.Shape.zo,s=[],v=Math,u=v.min,x=v.atan,w=v.sqrt,y=v.pow,B=v.floor,D=180/v.PI,A=nokia.maps.map.Polyline=new ovi.Class({Extends:nokia.maps.map.Spatial,initialize:function(a,b){a instanceof k.Strip||g(a)||e.d("Argument coords is not instance of geo.Strip or Array.");
var c=this.path=a instanceof k.Shape?a:new k.Shape(this.closedShape);a instanceof k.Shape?c.xb=this.closedShape:a instanceof k.Strip?c.tp(a):c.splice(0,0,a,"auto");this.sm={};(!b||!b.pen)&&(this.pen=this.penSetter());this._super(b);c.addObserver(this.Qu,this)},destroy:function(){this.path.destroy();this._super()},Statics:{Hi:100,Zr:s},Mi:null,u:"polyline",color:null,stroke:"solid",width:0,lineJoin:null,pen:null,arrows:null,closedShape:!1,ia:function(a,b){a==="path"?(this.ar(),b|=1):a!=="zIndex"&&
(b|=2);this._super(a,b)},Qu:function(a,b){this.ar();this.ia(b,1)},ar:function(){this.Mi=null;this.sm={}},getNearest:function(a){var b=this.path,a=this.getNearestIndex(a);return b.get(a)},getNearestIndex:function(a){for(var b=this.path.asArray(),c=b.length,d=k.Coordinate.fromObject(a),f,e=d.distance({latitude:b[0],longitude:b[1]}),g=0,a=3;a<c;a+=3)f=d.distance({latitude:b[a],longitude:b[a+1]}),f<e&&(g=a/3,e=f);return g},getBoundingBox:function(){var a=this.path,b=this.Mi;if(!b&&(b=a.getBoundingBox()))b.getWidth()==
360&&a.yb%2==1&&(b=b.merge(new h(new d(this.coverNorthPole?90:-90,0,void 0,!0),void 0,!0))),this.Mi=b;return b},pathSetter:function(a){var b=this.path;b.splice(0,b.getLength(),k.Strip.convertToArray(a),"unsafe values lat lng alt");return b},widthSetter:function(a){(a=e.Ja(a,0,A.Hi))!==a&&e.d("width must be in range [0.."+A.Hi+"]");this.pen=new r({lineWidth:a},this.pen);return a},strokeSetter:function(a){a!=="solid"&&e.d("cannot set anything else than stroke=solid");this.pen=new r({stroke:a},this.pen);
return a},colorSetter:function(a){l(a)===null&&e.d("color");this.pen=new r({strokeColor:a},this.pen);return a},lineJoinSetter:function(a){this.pen=new r({lineJoin:a},this.pen);return a},penSetter:function(a){a instanceof r||(a=new r(a));this.set("width",a.lineWidth);this.set("color",a.strokeColor);this.set("lineJoin",a.lineJoin);return a},arrowsSetter:function(b){return b instanceof a?b:b?new a(b):!1},coveredByTile:function(a,b,c){var d=a?a.length:0,f,e=this.lineWidth;if(this.closedShape)for(;d--;)if(q.isCoveredBy(b,
c,a[d],e,!0)){f=!0;break}return f||!1},drawToTile:function(a,b,e){var g=this.closedShape,k=this.getBoundingBox();h.fromObject([90,k.topLeft.longitude,-90,k.bottomRight.longitude],!0).contains(new d(0,180,void 0,1));var k=this.pen.lineWidth,p=this.pen.lineCap,r=this.pen.lineJoin,v=this.pen.miterLimit,w=e?2*(k>1?k:1)+0.13524:0,w=new f([new q(-w,-w),new q(a.getWidth()+w,a.getHeight()+w)]),b=this.path.clip(b,w,this.simplify,this.coverNorthPole,this.Pl,e,A.Hi),e=b.length,x,w=k||g,u,y,B;if(e){k&&(a.set("strokeColor",
l(this.pen.strokeColor)),a.set("lineWidth",k));p&&a.set("lineCap",p);r&&a.set("lineJoin",r);v&&a.set("miterLimit",v);g&&a.set("fillColor",this.brush.fill==="none"?m:l(this.brush.color));for(this.arrows&&(B=c(b,0,0,u=a.getWidth(),y=a.getHeight()));e--;){p=b[e];v=p.length;x=p[0];if(w){a.beginPath();a.moveTo(x.x,x.y);for(r=1;r<v;r++)a.lineTo((x=p[r]).x,x.y);g&&(a.closePath(),a.fill());k&&a.stroke()}for(r=v;r--;)p.push((x=p[r]).x,x.y);p.splice(0,v)}B&&this.lt(a,u,y,B,k);return!g||!b.fullfilled?b:s}else return b===
z?s:!1},Et:function(a){for(var b=a.length,c=0;--b;)c+=a[b].distance(a[b-1]);return c},lt:function(a,b,c,d,e){var g=this.arrows,l=e*g.width/2,e=e*g.length/2,h=e/2,k=e*2*g.frequency,p=w(y(e,2)+y(l,2)),b=new f([new q(p,p),new q(b-p,c-p)]),m,r,c=this.Et,s,z,v,A,Ba,S,ta;a.set("fillColor",g.color);for(g=d.length;g--;)if(z=0,p=d[g],m=p.length)if((r=c(p))>=k){s=u(B(r/k),1E3);r/=s+1;for(s=r/2;--m;){for(v=(A=p[m]).distance(Ba=p[m-1]);s<=z+v;)ta=A.x+(Ba.x-A.x)*(S=(s-z)/v),S=A.y+(Ba.y-A.y)*S,b.contains(new q(ta,
S))&&(a.save(),a.translate(ta,S),a.rotate(-x((Ba.y-A.y)/(A.x-Ba.x))*D-(A.x<Ba.x?270:90)),a.beginPath(),a.moveTo(-l,-e),a.lineTo(0,e),a.lineTo(l,-e),a.lineTo(0,-h),a.closePath(),a.fill(),a.restore()),s+=r;z+=v}}},project:function(a){return this.sm[a.id]||(this.sm[a.id]=a.geoToMapPoints(b.stencil(p,this.path.internalArray)))}})})(nokia.maps.util);ovi.provide("nokia.maps.map.render.p2d.dom.MapLayer");
(function(){function e(a,b){return a.Jk-b.Jk}var k=Math,h=k.abs,d=k.pow,c=k.round,g=nokia.maps,b=g.map.render.p2d.dom,f=g.dom,q=(k=f.Page.browser.mobile)?-1:-2,a=k?2:4;b.MapLayer=new ovi.Class({initialize:function(a,c,d,e){var g,h;this.uf=g=c.min;this.Ya=h=c.max;this.e=c;this.Da=e;this.o=a;this.Ej=a=[];this.Hp=d.fading*1.1+20;this.bm=ovi.bind(this,this.bm);for(this.Cb=ovi.bind(this,this.Cb);g<=h;g++)a[g]=new b.TileLayer(f.hb(this.o,"div"),c,d,this.Cb),a[g].$f=g},shutdown:function(){var a=this.uf,
b=this.Ej,c=b.length;for(this.Da=g.util.A;c--&&c>=a;)b[c].shutdown();f.bc(this.o);return this.o},stop:function(){for(var a=this.uf,b=this.Ej,c=b.length;c--&&c>=a;)b[c].stop()},Cb:function(a,b){if(a===this.sd){if(!b)this.Hp&&(this.Pt=setTimeout(this.bm,this.Hp));this.Da(this,!1)}},bm:function(){for(var a=this.sd.Jk;a--;)this.vr[a].hide()},zv:function(a){for(var b=this.Ej,c=b.length,d=this.uf,f;c--&&c>=d;)f=a-c,b[c].gw=f,b[c].Jk=-h(2*f-(f>0))},render:function(b,f,g,h,k,s,v,u,x,w,y,B,D){var y=c(y),A=
this.uf,C=this.Ya,E=this.Ej,M,H;clearTimeout(this.Pt);this.sd&&this.sd.$f!==y&&this.sd.stop();this.sd=E[y];this.zv(y);this.vr=y=E.slice(A,C+1).sort(e);for(H=y.length;H--;)y[H].Jk=H;for(E=!(H=y.length);H--;)A=y[H],C=A===this.sd,M=y[H].gw,E||M&&(M<q||M>a)?A.hide():(d(2,M),E=A.render(b,f,g,h,k,s,v,u,x,w,A.$f,B||!C,D)&&!C),this.vr[H].o.style.zIndex=H-100;return E},capture:function(a,b,c,d,f){this.sd&&this.sd.capture(a,b,c,d,f)}})})();ovi.provide("nokia.maps.map.Polygon");
(function(){var e=nokia.maps.util.Brush,k=nokia.maps.util.d;nokia.maps.map.Polygon=new ovi.Class({Extends:nokia.maps.map.Polyline,initialize:function(e,d){(!d||!d.brush)&&(this.brush=this.brushSetter());this._super(e,d)},u:"polygon",fillColor:null,brush:null,closedShape:!0,coverNorthPole:!1,Pl:136,fillColorSetter:function(h){var d=nokia.maps.gfx.Color,c=d.parseCss(h);c===null&&k("Invalid fillColor set!");this.Pl=d.alpha(c);this.brush=new e({color:h},this.brush);return h},brushSetter:function(h){var d=
nokia.maps.gfx.Color,c;h instanceof e||(h=new e(h));this.set("fillColor",h.color);c=d.parseCss(h.color);this.Pl=d.alpha(c);return h},coverNorthPoleSetter:function(e){return!!e}})})();ovi.provide("nokia.maps.map.Marker");
(function(){var e=nokia.maps,k=e.util,h=e.dom,d=e.map,c=e.gfx,g=k.Point,b=k.Strip,f=new g(0,0),q=k.Rectangle,a=d.Hb,r=e.geo,l=d.HitArea,m=r.Coordinate,e=new ovi.Class({Extends:d.Object,initialize:function(b,c){var d;if(this.u==="marker"&&(!c||!("icon"in c)))d=new a,this.set("icon",d.getIcon()),this.set("anchor",d.anchor),this.set("hitArea",d.hitArea);this.Qa={};this._super(c);this.set("coordinate",b,1)},u:"marker",anchor:f,f:f,coordinateSetter:function(a){(a=m.fromObject(a))||k.d("coord");this.Qa=
{};return a},hitAreaSetter:function(a){return!a?a:l.from(a)},anchorSetter:function(a){(a=g.fromObject(a))||k.d("you have to set util.Point");return a},draggableSetter:function(a){return this.isDraggable=a},Ka:function(a){this.f=new g(a.width,a.height);this.gc=1},iconSetter:function(a){ovi.type(a);a instanceof c.Image||(a=c.Image.fromObject(a));a instanceof c.Image||k.d("icon");this.icon=a.C===document?a:a.clone(document);a.state===1?this.Ka(a):this.gc=0;return this.icon},getBoundingBox:function(){return r.BoundingBox.coverAll([this.coordinate])},
getDisplayBoundingBox:function(a){a=a.geoToPixel(this.coordinate).sub(this.anchor);return new q([a,a.add(this.f)])},hitTest:function(a,b,c,d){var a=this.getDisplayBoundingBox(a),f=new g(b,c),e=this.hitArea;return a.contains(f)&&(!e||e.hitTest(b-a.topLeft.x,c-a.topLeft.y,d))},getDisplayOffset:function(a,b,c){return(new g(b,c)).sub(a.geoToPixel(this.coordinate))},ia:function(a,b){a!=="zIndex"&&(b|=a==="coordinate"?1:2);this._super(a,b)},fe:function(a){var b="error";a.state===1&&(this.Ka(a),this.ia("icon",
2),b="load");this.dispatch(new h.Event({type:b,target:this,relatedTarget:a}))},getIconForRendering:function(a){var b=this.icon;a!==document&&(b=b.clone(a));b.state?this.gc||b.state===1&&this.Ka(b):b.prepare(this.fe,this);return b},project:function(a){return this.Qa[a.id]||(this.Qa[a.id]=a.geoToMapPoints(b.stencil(b.LAT_LNG,[this.coordinate.latitude,this.coordinate.longitude])))}});if(d.Marker.isNs)d.Marker=e})();ovi.provide("nokia.maps.map.Rectangle");
(function(){var e=nokia.maps,k=e.util,e=e.geo,h=e.Strip,d=e.BoundingBox;nokia.maps.map.Rectangle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(c,d){c=this.boundingBoxSetter(c,1);this._super(this.zg(this.boundingBox=c),d)},simplify:0,u:"rectangle",zg:function(c){var d=c.topLeft,b=d.latitude,f=d.longitude,e=c.bottomRight,d=e.latitude,e=e.longitude,f=[b,f,b,e,d,e,d,f],e=0;if(c.getWidth()>=180)c=c.getCenter(),e=c.longitude,f.splice(6,0,d,e),f.splice(2,0,b,e);return new h(f,"unsafe values lat lng")},
boundingBoxSetter:function(c,e){c=d.fromObject(c)||k.d();e||this.set("path",this.zg(c));return c}})})();ovi.provide("nokia.maps.map.StandardMarker");
(function(){function e(c,d,b){c.U.set(d,b);if(d==="shape")c.f=c.U.f,c.set("anchor",c.U.anchor),c.set("hitArea",c.U.hitArea);return c.U[d]}var k=nokia.maps,h=k.util,d=k.map.Hb,k=nokia.maps.map.StandardMarker=new ovi.Class({Extends:nokia.maps.map.Marker,initialize:function(c,e){var b=this.U=new d(h.flatMerge({},e,1,d.Ta));h.flatMerge(this,b,1,d.Ta);this.f=b.f;this._super(c,h.flatMerge({},e,1,d.te))},u:"standardmarker",shapeSetter:function(c){return e(this,"shape",c)},textSetter:function(c){return e(this,
"text",c)},textPenSetter:function(c){return e(this,"textPen",c)},penSetter:function(c){return e(this,"pen",c)},brushSetter:function(c){return e(this,"brush",c)},getIconForRendering:function(c){this.set("icon",this.U.getIcon());return this._super(c)}});h.flatMerge(k.prototype,d.prototype,!0,d.Ta)})();ovi.provide("nokia.maps.map.provider.SpatialTile");
(function(){var e=nokia.maps,k=e.util.Point,h=e.dom.importNode,d=e.dom.cloneNode,c=e.map,g=c.Polyline.Zr,e=e.gfx,b=e.Graphics,f=e.IDL,q=e.GraphicsImage,a=e.Painter.defaultPainter.isVML,r=[],l=-1/0,m=r.concat,e=c.provider.SpatialTile=function(a,b,c,d){this.id=a;this.e=b;this.Th=c;this.tc=d;this.Jh={};this.Xm={}};ovi.extend(e.prototype=new c.provider.Tile(0,0,0),{fn:l,Bi:l,getIDL:function(){var a,b=this.Jp;return b&&new f(m.apply([f.opcodes.BEGIN_2D_IMAGE,(a=this.e).width,a.height,""],b))},getNode:function(b){var c=
this.data,f,e;if(!c&&(f=this.getIDL()))this.data=c=(new q(f,null,document)).createElement(),c.style.position="absolute";if(c){if(b&&b!==document)c=h(b,c,1);else if(a||(e=c.parentNode)&&e.nodeType!==11)c=d(c,1);return c}},Hs:function(){var a=this.Jh,b;this.Mh=null;for(b in a)a.hasOwnProperty(b)&&this.hp(a[b][0])},hp:function(a){var b=a.id,c=this.Jp,d,f=this.Jh;if(b in f){delete a.Ym[this.id];if((d=f[b][2])&&(d=c.indexOf(d))!==-1)c.splice(d,1),this.data=0,this.Bi=l;delete f[b]}},Tq:function(a,b,c){var d=
a.id,f=this.Jh;d in f||(a.Ym[this.id]=this);return f[d]=b?[a,b,c]:[a]},zb:function(a,b){var c,d=this.Xm,f,e,l,h,m,q,A,C,E;for(e in d)if(d.hasOwnProperty(e)&&(l=(f=d[e])[1])){h=f[0];if(!(m=l===g)){q=h.width||0;for(A=l.length;A--&&!m;)if(E=k.isCoveredBy(a,b,l[A],q,C=h.closedShape),C&&h.brush.fill==="none"&&E==="S"&&(E=!1),E&&C||!C&&(E==="E"||E==="V"))m=1}m&&(c||(c=[]),c.push(h))}return c||r},Yu:function(){var a=this.e,b=a.lb;if(this.fn<b)(a=a.Bt(this.Th,this.tc)).length?(this.Mh=a,this.state=void 0):
(this.Mh=null,this.state=!1),this.fn=b},paint:function(){var a=0,c=this.Mh,d=c.length;if(d){for(var f=this.e,e=this.Th,g=this.tc,l=f.width,f=f.height,h=[],k,m,r=this.Jh,q,E,M,H=new b;d--;){m=c[d];k=m.id;if(!(q=r[k]))H.beginImage(l,f),(k=m.drawToTile(H,e,g))?(q=this.Tq(m,k,H.getIDL().data.slice(4)),M=1):this.Tq(m);q&&(E=q[2])&&h.push(E)}this.Bi=this.fn;if(M)this.Jp=ovi.Array(h),this.data=0;h.length&&(a=1)}this.Mh=0;this.Xm={};for(var K in this.Jh)this.Xm[K]=r[K];return this.state=a!==0}}).constructor=
e})();ovi.provide("nokia.maps.map.Circle");
(function(){var e=nokia.maps,k=Math,h=k.asin,d=k.sin,c=k.cos,g=k.abs,b=k.PI,f=b/180,q=180/b,a=e.util,r=e.geo.Coordinate;nokia.maps.map.Circle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(a,b,c){this._super(this.zg(this.center=this.centerSetter(a,1),this.radius=this.radiusSetter(b,1),c&&"precision"in c?this.precisionSetter(c.precision,1):this.precision),c)},u:"circle",precision:60,centerSetter:function(b,c){b=r.fromObject(b)||a.d();b.equals(this.center)?b=this.center:c||this.Kn(b,
this.radius,this.precision);return b},radiusSetter:function(b,c){(b=a.Ja(b,0,1E7))!==b&&a.d("Passed argument is not a number.");c||this.Kn(this.center,b,this.precision);return b},precisionSetter:function(b,c){((b=a.Ja(b,4,360))!==b||b===Infinity)&&a.d("Passed argument is not a number or is a infinity.");c||this.Kn(this.center,this.radius,b);return b},Kn:function(a,b,c){this.set("path",this.zg(a,b,c))},zg:function(a,b,c){var d=270,c=360/c,f=[],a=r.fromObject(a);this.set("coverNorthPole",a.latitude>
0?!0:!1);if(g(a.latitude===90))f=this.Ns(a,b,c,d,630);else for(;d<630;d+=c)f.push(a.walk(d,b,1));this.Mi=null;return f},Ns:function(a,e,g,k,s){e/=6371E3;for(var v=[],a=f*a.latitude,u,x;k<s;k+=g)u=f*k,x=h(d(a)*c(e)+c(a)*d(e)*c(u)),u=(u+b)%(2*b)-b,v.push(new r(x*q,u*q));return v}})})();ovi.provide("nokia.maps.map.provider.TileProvider");
(function(){var e=nokia.maps,k=e.util.Cache,h=k.NEXT,d=k.DONT;new Image;var c=e.map.provider.SpatialTile,g=e.util,b=g.Event,f=g.Point,e=e.geo,q=e.PixelProjection,a=Math.floor;nokia.maps.map.provider.TileProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,initialize:function(a){var b,c,d={},e={},g,h,k,x;this._super(a);this.jc=new f(this.width,this.height);a=this.projection;g=this.width;h=this.height;k=this.max;for(x=this.min;k>=x;)b=1<<k,c=function(a,b){this.y=a*h;this.x=b*g},c.prototype=
new q(a,g*b,h*b),e[k]=new c(0,0),d[k--]=c;this.cs=d;this.pixelProjections=e;this.tileSize=new f(g,h)},width:256,height:256,opacity:1,alpha:!1,scalable:!0,cache:new k(128,function(a){return a.data?a:h},function(a){a.data&&!a.data.parentNode&&a.data.removeAttribute&&a.data.removeAttribute("src")},new k(512,function(a){a.data=null;return a instanceof c?a:h},function(a){a&&a.Hs()},new k(2048,function(a){return a instanceof c?d:a}))),projection:e.mercator,getInvalidations:function(a,b){var c=this.getInvalidationMark();
return(b<c||a.Bi<c)*1},createId:function(a,b,c,d){return d||(c=this.checkAddy(a,b,c))!==-1?this.id+"_"+a+"_"+b+"_"+c:!1},checkAddy:function(a,b,c){var d=1<<a;return a<this.min||a>this.max||b<0||b>=(d=1<<a)?-1:(c%=d)<0?c+d:c},cancel:function(a){var b=this.Va[a];if(b&&!--b.rk)return b.state=void 0,this.finishRequest(a,b,!0,!0),b},Es:function(){var a=this.Va,b,c;for(b in a)if((c=a[b])&&c.rk)c.rk=1,this.cancel(b)},finishRequest:function(a,c,d,f){var e;!d&&(e=this.cache)&&c.state!==void 0&&e.add(a,c);
delete this.Va[a];if(!f)d=new b("response"),d.data=[a,c.state?c:!1],this.dispatch(d)},request:function(a,b,c,d){var f,e,g=!1;if((c=this.checkAddy(a,b,c))!==-1)if(e=this.Va[f=this.createId(a,b,c,1)])d||(e.rk++,g=!0);else{if(g=this.cache)if((e=g.get(f))&&this.getInvalidations(e,this.lb)!==0)g.remove(f,!1),e=void 0;!d&&(e===void 0||e.state===!0&&!e.data)?(e=this.create(a,b,c,f,!1),e.state===void 0?(this.Va[f]=e,g=!0):g=e.state&&e):(e&&e.state===!0&&!e.data&&(e=this.create(a,b,c,f,!0)),g=e!==!0&&e&&e.state&&
e.data&&e||!1)}return g},getTileAdr:function(b){return new f(a(b.x/this.width),a(b.y/this.height))},getTileId:function(b,c,d){if((c=this.checkAddy(b,d=a(d/this.height),a(c/this.width)))!==-1)return this.createId(b,d,c,!0)},destroy:function(){var a=this.cache;a&&a.removeAll(this.id);this.Es()}})})();ovi.provide("nokia.maps.map.provider.SpatialTileProvider");
(function(){var e=nokia.maps,k=e.util.Coroutine,h=e.geo.BoundingBox,d=e.map,c=e.map.provider,g=c.SpatialTile;nokia.maps.map.provider.SpatialTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(b,f){this.Am=b;b.addListener("update",this.ye=ovi.bind(this,this.ye));this.mm=b instanceof c.LocalObjectProvider;this.label=b.label+"[Spatial]";this.min=b.min;this.max=b.max;this._super(f);this.ku=Math.round(d.Polyline.Hi/2)+1;this.Ih={};this.Wm(this);this.zf=ovi.Array()},
ww:1,sp:0,shutdown:function(){this.Am.removeListener("update",this.ye);this._super()},ye:function(){this.lb=this.Am.getInvalidationMark(!0)},finishRequest:function(b,c,d,a){this._super(b,c,d,a);a||this.fv(c)},fv:function(b){var c,d,a;a=(c=this.zf).length;for(d=0;d<a;d++)if(c[d]===b)return c.splice(d,1)},Wm:k.create("nokia.maps.map.provider.SpatialTileProvider#_paintCo",function(b){for(var b=b.that,c;c=b.zf.shift();)if(c.paint(1),b.finishRequest(c.id,c),k.shallYield())return k.yield();return k.wait(b.Ih)},
"that"),yt:function(b){for(var c=b.length,d=0;c--;)d+=b[c].path.internalArray.length;return d},create:function(b,c,d,a){b=new g(a,this,new this.cs[b](c,d),b);b.Yu();b.state!==!1&&(this.sp||this.yt(b.Mh)<3E3?(b.paint(),this.finishRequest(a,b,!1,!0)):(this.zf.push(b),k.signal(this.Ih)));return b},Bt:function(b,c){for(var d=this.mm,a=this.ku,a=this.Am.requestBBox(c?new h(b.xyToGeo(-a,-a),b.xyToGeo(this.width+a,this.height+a),!0):new h(b.xyToGeo(0,0),b.xyToGeo(this.width,this.height),!0),1,c),e=a.length,
g=-1,k=[],p;++g<e;)(p=d?a[g]:a[g].getObject(!0))&&k.push(p);return k}})})();ovi.provide("nokia.maps.map.provider.ImgTileProvider");
(function(){var e=nokia.maps,k=e.dom,h=e.util.now,d=e.map.provider.Tile,c=k.imgLoader;nokia.maps.map.provider.ImgTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(c){this._super(c);if(!c||c.timeout===void 0)this.timeout=3E4},create:function(e,b,f,q,a){var r=this,l,m=new d(q,l=document.createElement("img"),r),e=r.getUrl(e,b,f),p;a?k.loadImg(l,e)!==!0?k.cancelImg(l):m.state=!0:(p=h(),c.request(l,e,function(a,b,c){m.state=b;r.finishRequest(q,m,!b&&h()-p>r.timeout,
c)}));return m},cancel:function(d){var b;(b=this._super(d))&&c.cancel(b.data);return b}})})();ovi.provide("nokia.maps.map.provider.ObjectTileProvider");
(function(e){var k=e.net.Request,h=e.map.provider.Tile;nokia.maps.map.provider.ObjectTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(d){this._super(d);this.qk=new k(d.requestType||k.JSONP);this.db=[];this.Fa=0},Statics:{XHR:k.XHR,JSONP:k.JSONP},lu:e.dom.Page.browser.mobile?6:34,Up:function(){for(var d=this,c=0,e=d.db,b;c<e.length&&d.Fa<=d.lu;c++)b=e.shift(),d.qk.send(d.getUrl(b[0],b[1],b[2]),function(b,c){return function(a){if(!a.error&&!a.timeout)c.data=
a.response,c.state=!0,d.finishRequest(b,c);d.Fa--;setTimeout(function(){d.Up()},1)}}(b[3],b[4]),b[3]),d.Fa++},create:function(d,c,e,b,f){var k=new h(b,!1,this);f?this.Va[k.id]?this.cancel(k.id):k.state=!0:(this.db.push([d,c,e,b,k]),this.Up());return k},cancel:function(d){var c,e=0,b=this.db,f=this.db.length;if(c=this._super(d))for(;e<f;e++)if(b[e][4]===c){this.finishRequest(d,c,!0,!0);b.splice(e,1);break}return c}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.Engine");
(function(e){function k(a,b){return a instanceof b}var h=[],d=Number.POSITIVE_INFINITY,e=nokia.maps,c=e.util,g=c.A,b=c.d,f=c.vf,q=c.Vector3D,a=e.css.supportsTransition,r=self.clearTimeout,l=Math,m=l.pow,p=l.min,z=l.max,s=l.round,v=l.floor,u=l.LN2,x=l.log,w=l.abs,y=l.tan,B=l.sqrt,l=l.PI,D=c.Point,A=c.Ja,C=[].slice,E=e.geo,M=e.dom.Page.browser,H=E.mercator,K=y(35/180*l),P=l*6371E3,F=new D(256,256),L=[0,0,0,0],ea=[-256,-256,-256,-256],U=M.mobile?50:0,aa=E.Coordinate,la=E.BoundingBox,y=e.map,l=y.provider,
J=l.TileProvider,ba=l.LocalObjectProvider,G=l.RemoteObjectProvider,R=l.ImageProvider,Ba=l.CanvasProvider,S=y.render,ta=S.p2d,fa=ta.capabilities,I=ta.Animation,ga=fa.ZOOM,X=fa.COORD,ia=fa.SIZE,V=ta._helpers.geoToScreen,$a=0;ta.Engine=new ovi.Class({initialize:function(a,b,c,d){var d=d||{},f=this;f.c=$a++;f.Zi="nma_p2d_"+f.c;f.wv(d.fading);f.Ku=d.onViewChange||g;f.Gu=d.onStateChange||g;f.Fq=d.onValueExceeded||g;f.ek=d.onTransition||g;f.Ri=ovi.bind(f,f.Ri);f.Wa=new D(a.offsetWidth,a.offsetHeight);f.ke=
f.se(f.t=a);f.B={latitude:0,longitude:0,altitude:0,heading:0,tilt:0,incline:0,zoom:0,distance:0};f.Td={latitude:0,longitude:0,altitude:0,yaw:0,pitch:0,roll:0,fov:70};f.Z=new E.PixelProjection(H,2,2,1,1);f.mb=new D(0.5,0.5);f.Cd=[0,0,0,0];f.Iq=new D(0,0);f.pb=new D(0,0);f.$b=new D(0,0);f.eh=new e.map.render.InteractionRecorder;f.Cb=ovi.bind(f,f.Cb);f.ye=ovi.bind(f,f.ye);f.eu=0;f.fu=0;f.cd=2147483647;f.Jf("busy");f.lh=f.se(f.ke,void 0,!1,!0);f.setMapProvider(b);f.pr(c);f.Ut();f.Wk();f.dv=setTimeout(function(){d.onReady(f)},
1)},Statics:{TRANSITION:{AUTO:0,NONE:1,FADE:2,LINEAR:4,FLUID:8}},Ut:function(){var a=this.t;a.style[e.css.cw+"Transition"]+=","+e.css.so+"transform .15s linear";a.addEventListener&&a.addEventListener(e.css.Qr,ovi.bind(this,this.wu),!1)},loadDestinationCam:function(a,b){var c=this.viewToCam(a);this.Nn(a);this.ns=!0;this.update(!0,!0);b(c)},setHandoverProperties:function(){},exit:function(a,b){this.onExit=b;a?this.setCam(a):(this.onExit(),this.onExit=void 0)},enter:function(a,b){this.onEnter=b;a?this.setCam(a):
(b.call(this),this.onEnter=void 0)},TRANSITION_START:1,TRANSITION:2,TRANSITION_END:4,capabilities:fa,$e:0,Cb:function(){var a=this;this.Fj&&!--this.Fj&&setTimeout(function(){a.Jf("idle")},0)},nl:function(a,b){return k(a,ba)||k(a,G)||k(a,J)||k(a,R)||k(a,Ba)&&(!b||a.projection===this.Z.p)},xp:function(a){return this.ke.childNodes[a+1]},ls:function(a,b){for(var c=this.Vm,d,f=this.Bd,e,g=f.length;g--;)e=f[g],d=c.get(g),this.nl(d,!0)?e?k(d,ba)&&e.Fo(a,b):this.se(this.t,e.shutdown(),!0,!1):e&&this.se(this.t,
e.shutdown(),!0,!0)},setMapProvider:function(a){var b=this.Yc,c=this.rf,d,f,e=this.jc,g,l=this.Z,h={cssClass:this.Zi};if(a!==b&&(g=this.nl(a),this.lh=d=this.se(this.ke,this.lh,!0,!g),c&&(c.shutdown(),this.wk(b,!1),--this.$e),g?(this.wk(a,!0),++this.$e,k(a,J)?(h.fading=this.Ol,c=new this.lj.MapLayer(d,a,h,this.Cb),f=a.projection,b=a.tileSize):c=new this.lj.ObjectLayer(d,a,h,this.Cb,f=H,b=F)):b=c=void 0,e=this.Vm&&(f!==l.p||!b.equals(e)),this.Yc=a,this.rf=c,l.p=f,this.jc=b,g))this.Jr=b.x/b.y,this.uk(this.mb),
this.ec(A(this.B.zoom,a.min,a.max)),e&&this.ls(f,b)},wk:function(a,b){a[(b?"add":"remove")+"Listener"]("update",this.ye)},pr:function(a){var b,c,d=0;a?(b="add",this.Vm=a,this.Bd=ovi.Array([])):(b="remove",a=this.Vm);for(c=a.getLength();d<c;)this.Gq(a,b,a.get(d),d),d++;a[b+"Observer"](this.Gq,this);this.update(!1,!0)},Gq:function(a,b,c,d){var a=this.Bd,f,e=this.nl(c),g={cssClass:this.Zi};if(b==="add")f=this.se(this.ke,this.xp(d),!1,!e),e&&(++this.$e,this.wk(c,!0),(b=this.Zs(c,f,g))&&a.splice(d,0,b),
b?b.sa():this.ke.removeChild(f));else{if(b=a[d])this.wk(c,!1),f=b.shutdown(),--this.$e;f=a[d]?f:this.xp(d);a.splice(d,1);this.ke!==f&&f&&this.ke.removeChild(f)}this.update(!1,!0)},Zs:function(a,b,c){var d=this.lj,f=this.Cb;return k(a,ba)||k(a,G)?new d.ObjectLayer(b,a,c,f,this.Z.p,this.jc):k(a,J)?new d.TileLayer(b,a,c,f):k(a,R)?new d.ImageLayer(b,a,0,f):k(a,Ba)?new d.CanvasLayer(b,a,f):void 0},jc:F,Jr:1,ye:function(){this.update(!1,!0)},lb:Math.pow(-2,53),kl:function(a){var b=this.cd;if(b&&(++this.lb,
this.Ku(this,b,a),a))this.cd=0},Ri:function(){var a=this.state;this.jl=0;if(a!==this.av)this.Gu(this,this.av=a)},Jf:function(a){if(a!==this.state&&(this.state=a,!this.jl))this.jl=setTimeout(this.Ri,0)},shutdown:function(){this.Aa&&this.Aa.stop(!0);this.pr();this.setMapProvider();r(this.dv);c.cancelAnimationFrame(this.jd);r(this.Gf);r(this.jl);this.state="shutdown";this.Ri()},Qd:function(a,b,c){var d=this.Z,f=this.mb,e=d.w,a=d.x+=a;f.x=(d.x=(a%e+e)%e)/e;f.y=(d.y+=b)/d.h;c||this.ii(d.p.pointToGeo(f),
!0)},jr:function(a,b){a.i=b;a.Aj={x:this.mb.x,y:this.mb.y}},mw:function(){var a=this.rf.e,b=this.Z,c=this.B.zoom;return scale=new nokia.maps.util.Point(b.w/(Math.pow(2,c)*a.jc.x),b.h/(Math.pow(2,c)*a.jc.y))},Wk:function(){var a=this.Wa,b=this.pb,c=this.$b,d=this.Cd,f=d[0],e=d[3],g=a.x-e-d[1],a=a.y-f-d[2],d=this.Iq;b.x=c.x=s(g/2+e);b.y=c.y=s(a/2+f);this.sa(this.lh);d.x=z(g,0);d.y=z(a,0);this.vn();this.update(!0)},resize:function(a,b){this.Wa.x=a;this.Wa.y=b;this.cd|=ia;this.Wk()},setPadding:function(a,
b,c,d){this.Cd.splice(0,4,+a||0,+b||0,+c||0,+d||0);this.lb++;this.Wk()},suspend:function(){this.Jf("suspended")},resume:function(){this.Jf("idle")},type:"2d",Ol:0,wv:function(a){this.Ol=M.mobile?0:+a},Pf:0,setTransition:function(a,b){this.Pf=a;this.io=b},getView:function(){return this.B},uk:function(a,b){var c=this.mb,d=this.Z;d.x=d.w*(c.x=a.x);d.y=d.h*(c.y=a.y);b||this.ii(d.p.pointToGeo(c),!0)},ii:function(a,b){var c=this.B,d=this.Td;b||this.uk(this.Z.p.geoToPoint(a),!0);if(c.latitude!==a.latitude||
c.longitude!==a.longitude)c.latitude=d.latitude=a.latitude,c.longitude=d.longitude=a.longitude,this.cd|=X;this.vn();this.update(!1,!0)},vn:function(){this.ba=this.Hq=this.gq=0},ki:function(a,b,c,d,f){var e=this;e.Aa&&e.Aa.isRunning&&(e.Aa.stop(f),e.ek(e.TRANSITION_END));e.ek(e.TRANSITION_START);e.Aa=new I(function(){a.apply(a,arguments);e.ek(e.TRANSITION)},function(){b&&b.apply(b,arguments);e.ek(e.TRANSITION_END)},c,d);e.Aa.start()},Dp:function(){var a;if(this.onExit)a=this.onExit,this.onExit=void 0,
a();if(this.onEnter)a=this.onEnter,this.onEnter=void 0,a();this.kl()},Nt:function(a){var b=this.B;return b.latitude===a.latitude&&b.longitude===a.longitude&&(!isNaN(a.zoom)&&b.zoom===a.zoom||!isNaN(a.distance)&&b.distance===a.distance)},setView:function(a){var b=this,c=b.B.zoom,d=(a.zoom!==void 0?a.zoom:b.Hl(a.distance))-c,f,e=!0,g,l;b.Pf===ta.Engine.TRANSITION.AUTO&&b.No(a)&&!b.Nt(a)?b.ki(function(h){e&&(f=c+h*d,b.Ti(f)?e=!1:b.ec(c+h*d));g=b.Z.p.geoToPoint(a);l=b.mb;b.uk(new D(l.x+(g.x-l.x)*h,l.y+
(g.y-l.y)*h));b.update(!0,!0)},function(){b.Nn(a);b.Dp()},null,b.io):(b.Nn(a),b.Dp());return b.B},Nn:function(a){this.Pf=ta.Engine.TRANSITION.NONE;this.setCoord(a);isNaN(a.distance)?this.ec(a.zoom):this.setDistance(a.distance);this.Pf=ta.Engine.TRANSITION.AUTO},setCoord:function(a){var b=this,d=b.Z.geoToPixel(a),f=b.Z.geoToPixel(b.B),e=d.x-f.x,g=d.y-f.y,l,h,k=0;a&&aa.isValid(a.latitude,a.longitude,a.altitude)&&!(b.B.latitude===a.latitude&&b.B.longitude===a.longitude)?b.Pf===ta.Engine.TRANSITION.AUTO&&
b.No(a)?b.ki(function(a){l=f.x+(a-k)*e;h=f.y+(a-k)*g;b.Qd(l,h);b.update(!0,!0);k=a},function(){b.ii(a)},c.animation.easeFunctions.EASE_OUT_QUAD,b.io):b.ii(a):a=b.B;return new aa(a.latitude,a.longitude,a.altitude)},No:function(a){var b=this.Z.geoToPixel(this.B),a=this.Z.geoToPixel(a);return w(a.x-b.x)<=this.Wa.x&&w(a.y-b.y)<=this.Wa.y},Xk:function(a,b,c){c=c.width;return x((b.w=b.h=m(2,s(x(b.w/c)/u))*s(c*m(2,a-s(a))/2)*2)/256)/u},ec:function(a,b,c){var d=this.B,f=this.Z,e=b!==void 0,g=this.pb,a=A(a,
this.Yc.min,this.Yc.max);if(e)this.$b.x=b,this.$b.y=c,this.Qd(b-=g.x,c-=g.y,!0);f.w=m(2,a+8);a=this.Xk(a,f,this.Yc);if(a!==this.B.zoom)d.zoom=a,d.distance=this.Gi(a),this.cd|=ga;this.Td.altitude=d.distance+(d.altitude||0);this.uk(this.mb,!0);e?(a=this.sh(-c),this.Qd(-b,a,!1)):(this.vn(),this.update(!1,!0))},setZoom:function(a,b,c){var d=this,f=d.B,e=d.B.zoom,g=a-e,l=d.Yc;if((a=A(a,l.min,l.max))!==f.zoom&&!isNaN(a))d.Pf===ta.Engine.TRANSITION.AUTO?d.ki(function(a){d.ec(e+a*g,b,c);d.update(!0,!0)},
function(){d.ec(a,b,c)},null,d.io,!0):d.ec(a,b,c);return f.zoom},getZoom:function(){return this.B.zoom},Gi:function(a){var b=this.Yc;return A(P/m(2,a)/K,P/m(2,b.max)/K,P/m(2,b.min)/K)},Hl:function(a){return A(-(x(a*K/P)/u),this.Yc.min,this.Yc.max)},setDistance:function(a,b,c){var d=this.B;p(z(a,0),1/0)===a&&this.ec(this.Hl(a),b,c);return d.distance},setHeading:function(){return this.B.heading},setTilt:function(){return this.B.tilt},setIncline:function(){return this.B.incline},Yg:function(a){return a===
this.Cd?this.Hq||(this.Hq=this.yg(a)):a===ea?this.gq||(this.gq=this.yg(a)):a===L||!a?this.ba||(this.ba=this.yg(L)):this.yg(a)},yg:function(a){var b=this.Wa,c=this.pb,d=a[0]-c.y,f=a[3]-c.x,e=b.y-c.y-a[2],a=b.x-c.x-a[1],b=this.Z;f>a&&(f=a=0);d>e&&(d=e=0);d=b.pixelToGeo({x:f,y:d});e=b.pixelToGeo({x:a,y:e});if(a-f>=b.w)d.longitude=-(e.longitude=180);return new la(d,e)},sh:function(a){var b=this.Z,c;c=(b.y+a)/b.h;c<0?a=-b.y:c>1&&(a=b.h-b.y);return a},Ps:function(a,b,c,d){var c=a-c,f=b-d,d=B(m(c,2)+m(f,
2));a-=c/2;b-=f/2;d=x(m(2,this.Wt)*(d/this.Vt))/u;this.Ti(d,a,b)||w(this.B.zoom-d)>=0.1&&this.ec(d,a,b)},Ms:function(a,b,c,d){this.Qd(this.pj+(this.Np-this.pj)/2-(a+(c-a)/2),this.sh(this.qj+(this.Op-this.qj)/2-(b+(d-b)/2)))},getBBox:function(){return this.Yg(this.Cd)},getCenter:function(){return new aa(this.B.latitude,this.B.longitude,void 0,!0)},camToView:function(a){var b=aa.fromObject([a.latitude,a.longitude,0,a.altMode]),a=b.distance(new aa(a.latitude,a.longitude,a.altitude,!1,a.altMode),!0),
c=this.Hl(a),a=this.Gi(c);return ovi.extend({},this.B,b,{distance:a,zoom:c})},getCam:function(){return this.Td},setCam:function(a){this.setView(this.camToView(a));return this.getCam()},setCamCoord:function(a){this.ii(a);return new aa(a.latitude,a.longitude,a.altitude,!0)},setYaw:function(){return this.Td.yaw},setPitch:function(){return this.Td.pitch},setRoll:function(){return this.Td.roll},viewToCam:function(a){var b=a.distance,b=+b===b?b:this.Gi(a.zoom),a=aa.fromObject([a.latitude,a.longitude,b,
a.altMode]);return ovi.extend({},this.Td,a)},Gt:function(a,b,c){var d=this.Z,f=ovi.extend({},this.B),e=d.w;if(a||b)b=this.sh(-b*91.401472),a={x:(a*91.401472+d.x)%e/e,y:(d.y+b)/d.h},d=d.p.pointToGeo(a),f.latitude=d.latitude,f.longitude=d.longitude;if(c)f.zoom+=c,f.distance=this.Gi(f.zoom);f.distance=this.Gi(f.zoom);return f},qs:function(a,b,c,d){var f=this.B,d=d||1;if(a||b)b=this.sh(-b*91.401472*d),this.Qd(a*91.401472*d,b);c&&(a=f.zoom+c*d,this.Ti(a)||this.ec(a));this.update(!0,!0)},Ti:function(a){var b=
this.Yc;return a>b.max?(this.B.zoom!==b.max&&this.ec(b.max),this.Fq(ga,a),!0):a<b.min?(this.B.zoom!==b.min&&this.ec(b.min),this.Fq(ga,a),!0):!1},Vi:!1,beginControl:function(a,b,c,d){this.Vi=C.call(arguments,0);this.zj=b;this.Ts=ovi.extend({},this.getView());this.nw=c;this.ow=d;this.Aa&&this.Aa.isRunning&&this.Aa.stop(!0)},control:function(a,b,c,f,e,g,l,h){var k=this,m=k.B,p,f=f||h;if(k.Vi)k.ki(function(a,d,e){p=m.zoom+f*e;k.Ti(p)?f=0:k.qs(b,c,f,e);if(this!==k.Aa)return!0},null,null,d),k.Vs=b,k.Ws=
c,k.Xs=f,k.pw=h},endControl:function(a){var b=this.zj,c,d,f,g=this.B;d=!1;if(this.Vi)this.Vi=!1,this.Aa&&this.Aa.isRunning&&this.Aa.stop(),b&&(c=new q(this.Vs,this.Ws,this.Xs),d=c.normalize(),f=c.magnitude(),c=typeof b.duration==="function"?b.duration(f):600,b=typeof b.power==="function"?b.power(f):1,f*=b,b=new e.map.render.KineticMove(f,-(f/c)),b=b.getPath(c),d=this.Gt(d.x*b,d.y*b,d.z*b)),a=typeof a==="function"?a(this.Ts,g):d,a!==!1&&(this.setTransition(ta.Engine.TRANSITION.NONE,c),this.setView(a),
this.setTransition(ta.Engine.TRANSITION.AUTO,c))},ms:function(a){if(a&=fa.ui)for(var b=a&X,c=X,d=0;c>>=1;){if(a&c&&(b|=c,++d>1))break}else b=X;return b},beginInteraction:function(a,b,c,d,f,e,g){if(this.im)this.Kl=null,this.Aa&&this.Aa.isRunning&&this.Aa.stop(),this.endInteraction();if(this.oj=this.ms(a)){this.im=!0;this.pj=d;this.qj=f;if(e===+e&&g===+g)this.Np=e,this.Op=g;this.Vt=B(m(d-e,2)+m(f-g,2));this.Wt=this.B.zoom}if(this.zj=b)this.eh.reset(),this.eh.recordXY(c,d,f)},interact:function(a,b,c,
f,e){var g,l;if(this.im&&(!this.Xp||a-this.Xp>U)){if(a!==d)this.Xp=a;f===+f&&e===+e?(this.oj&X&&this.Ms(b,c,f,e),this.oj&ga&&this.Ps(b,c,f,e),this.Np=f,this.Op=e):this.oj&X&&(g=this.sh(this.qj-c),l=this.pj-b,this.Qd(l,g));this.pj=b;this.qj=c;this.zj&&this.eh.recordXY(a,b,c,f,e)}},endInteraction:function(a){var b=this,c=b.zj,d=b.Z,f,g,l,h,k,m,p;c&&(f=b.eh.getInteractionDirection(a),h=b.eh.getInteractionSpeed(a),g=typeof c.duration==="function"?c.duration(h):600,a=typeof c.power==="function"?c.power():
1,k=h*a,p=new e.map.render.KineticMove(k,-(k/g)),!isNaN(f.x)&&!isNaN(f.y)&&k>0&&b.ki(function(a){k=p.getValue(a*g);if(b.oj&X&&!isNaN(k)){m=-f.y*k;l=(d.y+m)/d.h;if(l<0||l>1)f.y=-f.y,m=-f.y*k;b.Qd(s(-f.x*k),s(-f.y*k),!1);b.update(!0,!0)}},null,c.ease,g));b.im=!1},setPointer:g,screenToGeo:function(a,b){return this.Z.pixelToGeo(new D(a-this.pb.x,b-this.pb.y))},geoToScreen:function(a){return V(a,this.Z).add(this.pb).round()},convertAlt:function(a,b){var c=a.altMode||"GL";return c===(b||"GL")?a.altitude:
NaN},viewForXY:function(a,b){return ovi.extend({},this.B,this.Z.pixelToGeo(new D(a-this.pb.x,b-this.pb.y)))},viewForBBox:function(a){var b=fa.view.zoom.max,c=ovi.extend({},this.B,a.getCenter()),d,f,e=this.Iq,g;a.isEmpty()||(f=new E.PixelProjection(this.Z.p,d=m(2,b),d*this.Jr),g=f.geoToPixel(a.topLeft),f=f.geoToPixel(a.bottomRight),b-=8+z(x(a.isCDB?d-g.x+f.x:f.x-g.x)/u-x(e.x)/u,x(f.y-g.y)/u-x(e.y)/u));c.zoom=v(b);c.distance=NaN;return c},viewFor:function(a){for(var b=[],c=a.length;c--;)b.push(a[c].getBoundingBox());
return this.viewForBBox(la.merge(b))},getObjectAt:function(a,b){return this.zb(a,b,!0)[0]},getObjectsAt:function(a,b){return this.zb(a,b,!1)},zb:function(a,b,c){var d=ta.ObjectLayer,e=this.Bd,g=e.length,l,k,m,p=!1,q=this.Z,r=this.pb;a-=r.x;b-=r.y;for(c=!!c;g--;)if((l=e[g])&&l instanceof d)if(k=l.zb(a,b,f((q.x+a)/q.w,1),f((q.y+b)/q.h,1),c),k.length){if(c)break;m=p?m.concat(k):k;p=!0}return m||k||h},getObjectsWithin:function(a,b,c,d){for(var f=this.Wa,a=this.yg([b,f.x-c,f.y-d,a]),b=this.Bd,c=b.length,
d=[];c--;)f=b[c],f.wp&&(f=f.wp(a))&&f.length&&(d=d.concat(f));return d},capture:function(a,b,c,d){var f=this.Wa,a=A(a||0,0,f.x),b=A(b||0,0,f.y),c=A(c||f.x,a,f.x),d=A(d||f.y,b,f.y),f=(new e.gfx.Graphics).beginImage(c-a,d-b,"capture"),g=this.Bd,l=g.length,h;this.rf.capture(f,a,b,c,d);for(h=0;h<l;h++)g[h].capture(f,a,b,c,d);return f},preload:function(a,c){a||b("view");return new S.Preloader([],c)},bounce:function(b,c,d){a()&&(c&&d&&(this.t.style[e.css.getVendorJsProperty("transformOrigin")]=[c,"px ",
d,"px"].join("")),this.t.style[e.css.getVendorJsProperty("transform")]="matrix("+(!b?".9, 0, 0, .9, 0, 0":"1.1, 0, 0, 1.1, 0, 0")+")")},wu:function(a){if(/\btransform$/.test(a.propertyName))a=a.target.style,a[e.css.getVendorJsProperty("transform")]!=="matrix(1, 0, 0, 1, 0, 0)"?a[e.css.getVendorJsProperty("transform")]="matrix(1, 0, 0, 1, 0, 0)":this.jw=!0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.ObjectLayer");
(function(e){var k=[],h=e.map.provider,d=h.SpatialTileProvider,c=h.LocalObjectProvider;e.map.render.p2d.ObjectLayer=new ovi.Class({initialize:function(d,b,f,e,a,h){this.Dj=f;this.wf=ovi.bind(this,this.wf);this.o=d;this.e=b;this.Mt=b instanceof c;this.Da=e;this.Fo(a,h);this.Xo()},Fo:function(c,b){var f=this.yk;if(this.jn!==c||!b.equals(this.jc))this.jn=c,this.jc=b,f&&f.shutdown(),this.yk=new d(this.e,{projection:c,width:b.x,height:b.y}),this.Zo(),this.yk.sp=1},Dr:0,wf:function(c){(this.Dr|=c===this.Eb?
1:2)===3&&this.Da(this,!1)},shutdown:function(){this.Da=e.util.A;this.Eb.shutdown();this.qe.shutdown();e.dom.bc(this.o);return this.o},sa:e.util.A,stop:function(){this.Eb.stop();this.qe.stop()},render:function(c,b,d,e,a,h,l,k,p,z,s,v,u,x){var w=this.Eb.render(c,b,d,e,a,h,l,k,p,z,s,v,u,x),c=this.qe.render(c,b,d,e,a,h,l,k,p,z,s,v,u,x);this.Dr=0;return w&&c},zb:function(c,b,d,e,a){c=this.qe.zb(c,b,a);if(!a||!c.length)c=c.concat(this.Eb.zb(d,e,a));return c},wp:function(c){var c=this.e.requestBBox(c,3),
b;if(!this.Mt)for(b=result.length;b--;)c[b]=c[b].getObject();return c||k},capture:function(c,b,d,e,a){this.Eb.capture(c,b,d,e,a);this.qe.capture(c,b,d,e,a)}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.canvas.ObjectLayer");
(function(){var e=nokia.maps.map.render.p2d,k=e.canvas,h=k.MarkerLayer,d=k.SpatialTileLayer;k.ObjectLayer=new ovi.Class({Extends:e.ObjectLayer,sa:function(){this.Eb.sa();this.qe.sa()},Xo:function(){this.qe=new h(this.o,this.e,this.Dj,this.wf)},Zo:function(){this.Eb=new d(this.Eb?this.Eb.shutdown():this.o,this.yk,this.Dj,this.wf)}})})();ovi.provide("nokia.maps.map.js.nlpTileProviders");
(function(e){function k(c){c=new e.map.provider.ImgTileProvider(c);c.getUrl=function(a,c,d){this.tt||this.st();var f=this.subDomains,e=this.mode==="community"?"."+this.mapColors:this.mapType+"."+this.mapColors,f=[this.protocol,f?f[(c+d)%f.length]+".":"",this.baseUrl,this.tileType?this.tileType+"/":"",this.version?this.version+"/":"",e.length>1?e+"/":"",this.mode==="nokia"?r.nokia(a,c,d)+this.width+"/":"",this.imgType,this.mode==="community"?r.navteq(a,c,d):""],e=this.additionalParameters,g=[],l;if(this.mode===
"navteq")e.quadKey=r.navteq(a,c,d);for(l in e)g.push(encodeURI(l+"="+e[l]));f.push(g.length>0?"?"+g.join("&"):"");return b.addNlpParams(f.join(""),!0)};c.st=function(){var b=this.additionalParameters,c=f.defaultLanguage;if(!b.lg&&f.defaultLanguage&&(c&&(c=c.substr(0,2)),c&&(c=a[c]),c))b.lg=c;this.tt=!0};c.setTileVersion=function(a){if(a!=this.version)this.version=a,this.update()};c.setTileLanguage=function(a){this.additionalParameters.lg=a;this.update()};c.getCopyrights=function(a,b){return g.copyrights.get(this.mapType===
"traffic"?"normal":this.mapType,a,b)};c.timeout=-1;return c}function h(a){var b,c=f.serviceMode;for(b in a)if(a.hasOwnProperty(b)&&a[b].service)a[b].baseUrl=l.baseUrl.replace("{service}",a[b].service).replace("{serviceMode}",c?"."+c:"")}var d=e.config,c=e.util,g=e.map.js,b=nokia.maps.util.services,f=c.getRootNameSpace("nokia.maps").Settings,q=g.nlpTileProviders,a={en:"ENG",zh:"CHI",es:"SPA",fr:"FRE",it:"ITA",de:"GER",ru:"RUS"},r={nokia:function(a,b,c){return a+"/"+c+"/"+b+"/"},navteq:function(a,b,
c){for(var d,f=[];a-- >0;)d=1<<a,f.push(((c&d)!==0)+((b&d)!==0)*2);return f.join("")}},l={min:0,max:20,width:256,height:256,label:"Map",description:"Show street map",protocol:"http://",subDomains:[1,2,3,4],baseUrl:"{service}.maps{serviceMode}.api.here.com/maptile/2.1/",tileType:"maptile",version:"newest",mapType:"normal",mapColors:"day",additionalParameters:{},mode:"nokia",imgType:"png8",providerType:"base"},m={NORMAL:{service:"base"},SATELLITE:{mapType:"hybrid",label:"Hybrid",description:"Show hybrid imagery",
service:"aerial"},SATELLITE_PLAIN:{mapType:"satellite",label:"Satellite",description:"Show satellite imagery",service:"aerial"},TERRAIN:{mapType:"terrain",label:"Terrain",description:"Show terrain map",service:"aerial"},SMARTMAP:{mapColors:"day.grey",label:"Smart Map",description:"Show smart map",service:"base"},SMART_PT:{mapColors:"day.transit",label:"Public Transit Map",description:"Show public transport",service:"base"},TRAFFIC:{tileType:"traffictile",label:"Traffic Map",description:"Show traffic",
updateCycle:169,service:"traffic"},NORMAL_COMMUNITY:{baseUrl:"communitymaptiles.nokia.com/tilehub/",mapType:"normal",mapColors:"",tileType:"live/map",imgType:"png/",mode:"community",min:1,version:null,label:"Community Map",description:"Show map with live community edits",updateCycle:180},SATELLITE_COMMUNITY:{baseUrl:"communitymaptiles.nokia.com/tilehub/",mapType:"satellite",mapColors:"",tileType:"live/sat",imgType:"png/",mode:"community",min:1,version:null,label:"Community Satellite Map",description:"Show satellite map with live community edits",
updateCycle:180}},p,z=[],s=[],v={},u;for(p in m)u=k(c.flatMerge(m[p],l)),(u.providerType==="base"?z:s).push(v[p]=u),u.label==="Traffic Map"&&s.push(v[p]=u);q.constants=v;q.base=z;q.overlays=s;if(c.isWebGl()&&d.includeWebGL)q.constants.GLOBE=new nokia.maps.map.provider.GlobeProvider,q.constants.PANORAMA=new nokia.maps.map.provider.PanoramaProvider,q.constants.COVERAGE=new nokia.maps.map.provider.ImgTileProvider({max:20,getUrl:function(a,c,d){return b.addNlpParams(["http://"+((c+d)%4+1)+".maps.nxt.nlp.nokia.com/maptiler/v2/rctile/newest/normal.day",
a,d,c,"256/png8?lg=ENG"].join("/"))},getCopyrights:function(a,b){return g.copyrights.get("normal",a,b)}});h(q.constants);f.addObserver("serviceMode",function(){h(q.constants)})})(nokia.maps);ovi.provide("nokia.maps.map.overlay.TrafficIncidentsProvider");
(function(e){var k=e.util.Event,h=e.gfx.BitmapImage,d={x:12,y:12};nokia.maps.map.overlay.TrafficIncidentsProvider=new ovi.Class({Extends:e.map.provider.RemoteObjectProvider,initialize:function(c){var d=this.tileSize,b;this._super(c);b=1<<this.max;this.Ck=new e.map.provider.ObjectTileProvider(c);this.Ip=this.zs();this.Va={};this.xc={};this.Rt=new e.language.Manager;this.Ck.addListener("response",this.ra=ovi.bind(this,this.ra));this.jn=new e.geo.PixelProjection(nokia.maps.geo.mercator,d*b,d*b)},tileSize:256,
width:256,height:256,ra:function(c){var d=c.data[1],b=c.data[0],f=this.Va,e,a;delete this.xc[b];for(e in f){a=f[e];c=a.Dd.indexOf(b);if(c!==-1)a.Dd.splice(c,1),a.Ef=a.Ef.concat(this.gn(d));if(!a.Dd.length)c=new k("response"),c.data=[e,a.Ef],this.dispatch(c),delete f[e]}},zs:function(){var c=e.loadPath+"assets/ovi/mapsapi/ui/images/trafficitems/";return{CONSTRUCTION:new h(c+"construction.png",function(){},24,24),EVENT:new h(c+"event.png",function(){},24,24),"MASS TRANSIT":new h(c+"masstransit.png",
function(){},24,24),INCIDENT:new h(c+"incident.png",function(){},24,24)}},requestBBox:function(c,d,b,f){if(d!==2)return!1;var d=this.jj(c,b),e=this.Va[d];e?!f&&e.Fa++:f||(e=this.Va[d]={Fa:1,Ef:[],Dd:new ovi.Array});if(e&&e.Dd.length&&e.Fa>1&&!f)return!0;return this.iv(c,b,f)},cancelBBoxRequest:function(c,d,b){var d=this.Va,c=this.jj(c,b),f=d[c],e=this.xc,a;if(f&&(b=f.Dd,a=b.length,f.Fa--,!f.Fa)){for(;a--;)f=b[a],e[f]===1?(this.Ck.cancel(f),e[f]=void 0):e[f]--;delete d[c]}},iv:function(c,d,b){var f=
this.vp(c,d),e=f[0],a=f[1],h=f[2],f=f[3],c=this.jj(c,d),l,k,p,z,s=this.xc,v=[];for(k=e;k<h+1;k++)for(p=a;p<f+1;p++)if(z=this.Ck.request(d,k,p,b),b)z&&(v=v.concat(z.data.proxies||this.gn(z)));else if(l=this.Va[c],z===!0)e=this.Ck.createId(d,k,p,!0),z&&l.Dd.indexOf(e)===-1&&(l.Dd.push(e),this.xc[e]?s[e]++:s[e]=1);else if(z!==!1)l.Ef=l.Ef.concat(z.data.proxies||this.gn(z));if(b)return v;else{if(!l)return!1;return l.Dd.length?!0:(v=l.Ef,delete this.Va[c],v)}},jj:function(c,d){return this.vp(c,d).join("_")},
vp:function(c,d){var b=this.max,f=this.tileSize,e=this.jn,a=e.geoToPixel(c.topLeft),e=e.geoToPixel(c.bottomRight);return[a.y/f>>b-d,a.x/f>>b-d,e.y/f>>b-d,e.x/f>>b-d]},getInvalidations:function(c,d){return c.getInvalidations(d)},gn:function(c){var g=c.data,b,f,h,a,k=[];if(g.TRAFFICITEMS&&g.TRAFFICITEMS.TRAFFICITEM){f=g.TRAFFICITEMS.TRAFFICITEM;for(g=f.length;g--;)if(b=f[g],b.LOCATION&&b.LOCATION.GEOLOC&&b.LOCATION.GEOLOC.ORIGIN)h=new e.geo.Coordinate(b.LOCATION.GEOLOC.ORIGIN.LATITUDE,b.LOCATION.GEOLOC.ORIGIN.LONGITUDE),
a="",b.TRAFFICITEMDESCRIPTION&&(a+=b.TRAFFICITEMDESCRIPTION[1].content+"<br/>"),b.CRITICALITY&&b.CRITICALITY.DESCRIPTION&&(a+=this.Rt.translateToken("ovi.service.map._t90")+": "+b.CRITICALITY.DESCRIPTION),h=new e.map.Marker(h,{icon:this.Ip[b.TRAFFICITEMTYPEDESC]||this.Ip.INCIDENT,anchor:d,isRemote:!0,$content:a}),h.e=this,b=h.Nc(),b[h.CHANGE_SPATIAL]=b[h.CHANGE_VISUAL]=b[h.CHANGE_ZINDEX]=this.lb,k.push(function(a){return{getObject:function(){return a}}}(h))}return c.data.proxies=k},rc:function(){this.update();
return++this.lb},adopt:function(){return!1},orphan:function(){return!1}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.ObjectLayer");
(function(){function e(c){c=c.appendChild(c.ownerDocument.createElement("div"));c.style.position="absolute";c.style.zIndex=0;return c}var k=nokia.maps.map.render.p2d,h=k.dom,d=h.MarkerLayer,c=h.SpatialTileLayer;h.ObjectLayer=new ovi.Class({Extends:k.ObjectLayer,Xo:function(){this.qe=new d(e(this.o),this.e,this.Dj,this.wf)},Zo:function(){this.Eb=new c(this.Eb?this.Eb.shutdown():e(this.o),this.yk,this.Dj,this.wf)}})})();ovi.provide("nokia.maps.map.render.p2d.canvas.Engine");
(function(){var e=nokia.maps,k=e.util,h=k.requestAnimationFrame,d=[-256,-256,-256,-256],e=e.map.render.p2d,c=e.canvas;c.Engine=new ovi.Class({Extends:e.Engine,initialize:function(c,b,d,e){this.Ea=ovi.bind(this,this.Ea);this.pk=ovi.bind(this,this.pk);this.un=ovi.bind(this,this.un);this._super(c,b,d,e)},Statics:{TRANSITION:e.Engine.TRANSITION},lj:c,se:function(c){if(!this.o)this.o=c.ownerDocument.createElement("canvas"),this.kr(c),this.o.style.position="absolute",this.Ud=this.o.getContext("2d"),c.appendChild(this.o);
return this.o},sa:function(){var c=this.Bd,b=c.length;this.kr(this.t);for(this.rf.sa();b--;)c[b].sa();this.update(!0)},kr:function(){var c=this.Wa.y;this.o.width=this.Wa.x||1;this.o.height=c||1},update:function(c,b){if(!this.dh){this.dh=!0;this.kl(!0);if(c)this.Ea(b);else{if(!this.jd)this.jd=h(this.pk);if(!this.Gf)this.Gf=setTimeout(this.un,150)}this.dh=!1}},pk:function(){this.Ea(!0);this.jd=h(this.pk)},un:function(){this.Ea(!1);this.Gf=0},Ea:function(c){var b,f,e=this.Bd,a=e.length;f=this.Wa;var h=
this.pb;this.Jf("busy");this.Ud.clearRect(0,0,f.x,f.y);this.Fj=this.$e;(b=this.rf)&&b.render(this.B.zoom,this.mb,this.Z,this.Cd,this.Wa,h,this.Yg(d),0,0,0,this.B.zoom,c,this.$b,this.lb);for(f=0;f<a;)(b=e[f++])&&b.render(this.B.zoom,this.mb,this.Z,this.Cd,this.Wa,h,this.Yg(d),0,0,0,void 0,c,this.$b,this.lb);if(!c)this.$b.x=h.x,this.$b.y=h.y},Cb:function(c){this._super(c);this.update(!1,!0);if(!this.Fj)k.cancelAnimationFrame(this.jd),this.jd=0}})})();ovi.provide("nokia.maps.map.Display");
(function(e){var k=e.css,h=e.util,d=h.Point,c=Math,g=c.max,b=e.dom.Page.browser,f=c.round,q=h.Ja,a=h.d,c=e.gfx,r=c.Painter.defaultPainter===c.CanvasPainter,l=e.map,m=l.render.Capabilities.prototype,p=e.geo.Coordinate,z=e.dom,s={add:"attach",remove:"detach"},v=ovi.buildNS(e.config.tileProviders),u=l.Display=new ovi.Class({Extends:l.Container,initialize:function(a,b){var c=this,f,g,b=b||{};g=p.fromObject(b.center||b.view||[0,0]);f=b.view?b.view:g?ovi.extend({zoom:b.zoomLevel||0,altitude:0},g):{latitude:0,
longitude:0,altitude:0,zoom:0};b.center=g;c.default2dRenderMode=b.default2dRenderMode||c.default2dRenderMode;c.pm=0;c.sf=0;c.pf=!0;c.O=new l.$r;e.util.getRootNameSpace("nokia.maps").Settings.lockLanguage();e.map.js.copyrights.loadCopyright();c.availableBaseMapTypes=new h.OList(v.base);v.constants.PANORAMA&&v.constants.PANORAMA.setBaseUrl();g=b&&b.baseMapType||c.availableBaseMapTypes.get(0);c.availableOverlays=new h.OList(v.overlays);c.overlays=new h.OList;c.Ll=new h.OList;c.overlays.addObserver(c.Ou,
c);c.Rs(a);c.f=new d(c.da.offsetWidth,c.da.offsetHeight);c.aj=c.f.divide(2).round();c.Km=ovi.bind(c,c.Km);c.Hm=ovi.bind(c,c.Hm);c.Jm=ovi.bind(c,c.Jm);c.Im=ovi.bind(c,c.Im);c.Gm=ovi.bind(c,c.Gm);c.addObserver("baseMapType",ovi.bind(c,c.uu));c.xd=f;c.copyrightPosition=c.poweredByPosition=new d(0,0);c.fading="fading"in b?b.fading:150;c.components=new h.OList;c.components.addObserver(c.Ls,c);c.set("baseMapType",g);c.components.gs=c.components.M;c.components.M=function(a,b,c){for(var d=this.ha,f=d.length,
e=a.getId();f--;)d[f].getId()===e&&h.d('Component instance with ID "'+e+'" already registered');this.gs(a,b,c)};g=b.components;delete b.components;b.viewBounds&&(delete b.center,delete b.zoomLevel,delete b.view,delete b.cam);c._super(b);c.Ll.add(new l.provider.LocalObjectProvider(this,{min:-8,max:22}));f=c.parentDisplay;c.Xi=(c.xw=f&&f.visibility&&f.width>c.width&&f.height>c.height)?null:e.map.yo&&new e.map.yo(c);c.cd=0;c.tm=0;if(g)c.components.addAll(g),b.components=g;c.addListener("mouseleave",
c.Ln);c.addListener("mousemove",c.Ln);c.insertListener("drag",c.Ln);c.jg=ovi.bind(c,c.jg);c.addListener("mapvalueexceeded",c.jg,!1);c.addObserver("bounceEnabled",function(a,b,d){d?c.addListener("mapvalueexceeded",c.jg,!1):c.removeListener("mapvalueexceeded",c.jg,!1)});c.Eo()},destroy:function(){for(var a,b=this.components;b.getLength()>0&&(a=b.get(0));)this.removeComponent(a);this.Qs();this.ln=this.ko=null;try{this.m&&this.m.shutdown()}catch(c){c.toString()!=="Error: Permission denied"&&c.toString()!==
"[object Error]"&&h.d(c)}this.m=null;clearTimeout(this.Hk);clearTimeout(this.tm)},Ou:function(a,b,c,d){var f=this.Ll;if(b==="add"){if(f.add(c,d),c==null||a.indexOf(c)!==d)return!0}else f.removeAt(d)},animation:new h.OList(["none","default"]),u:"display",copyrightAlignment:"bottomleft",copyrightWidth:0,copyrightHeight:0,minZoomLevel:0,maxZoomLevel:0,zoomLevel:0,minTilt:0,maxTilt:0,tilt:0,minHeading:0,maxHeading:0,heading:0,padding:{top:0,right:0,bottom:0,left:0},poweredByWidth:0,poweredByHeight:0,
fixedCenter:!0,margin:64,default2dRenderMode:"dom",focus:function(){this.da.focus()},blur:function(){this.da.blur()},setZoomLevel:function(a,b,c,d){this.zc(b);if(this.O.inProgress)return a;this.Vr(a,c,d);this.m.setZoom(h.Ja(a,this.minZoomLevel,this.maxZoomLevel),c,d)},setCenter:function(a,b){this.O.inProgress||(this.zc(b),this.m.setCoord(p.fromObject(a)))},setHeading:function(a,b){this.O.inProgress||(this.zc(b),this.m.setHeading(h.Ja(a,this.minHeading,this.maxHeading)))},setTilt:function(a,b){this.O.inProgress||
(this.zc(b),this.m.setTilt(h.Ja(a,this.minTilt,this.maxTilt)))},setView:function(a,b){if(!this.O.inProgress)return this.zc(b),this.m.setView(a)},setCam:function(a,b){if(!this.O.inProgress&&!this.dw(a.fov))return this.zc(b),this.m.setCam(a)},setPadding:function(a,b,c,d){var f=arguments.length,f=f>3?[a,b,c,d]:f>2?[a,b,c,b]:f>1?[a,b,a,b]:[a,a,a,a];this.set("padding",{top:f[0],right:f[1],bottom:f[2],left:f[3]})},setAttributes:function(a,b,c,d,f){this.O.inProgress||(b!==void 0&&this.set("center",b),c!==
void 0&&this.set("zoomLevel",c),d!==void 0&&this.set("tilt",d),f!==void 0&&this.set("heading",f))},setCopyrightAlignment:function(a){this.set("copyrightAlignment",a)},setBaseMapType:function(a,b,c){if(!this.O.inProgress){this.ps=b==="default"?!0:!1;if(c)this.xd=c;this.set("baseMapType",a)}},setTransition:function(a){this.O.inProgress||this.m.setTransition(a)},getZoom:function(a,b){return this.m.getZoom&&this.m.getZoom(a,b)||this.getView().zoom},getView:function(){if(this.O.inProgress&&!this.pf)return this.hu;
return ovi.extend({},this.m.getView())},getCam:function(){if(this.O.inProgress&&!this.pf)return this.du;return ovi.extend({},this.m.getCam())},getComponentById:function(a){for(var b=-1,c=this.components.getLength(),d;++b<c;)if((d=this.components.get(b))&&d.getId()===a)return d;return null},addComponent:function(a){var b=this.getComponentById(a.getId());if(b)return b.queryReference();this.components.add(a);return a},removeComponent:function(a){var b=a.releaseReference();b<=0&&this.components.remove(a);
return b},Ls:function(a,b,c){(a=s[b])&&c[a](this);a==="attach"&&this.Do(c)},Do:function(a){a.isCompatible(this.m.type)?a.set("enabled",!0,!0):a.set("enabled",!1,!0)},Eo:function(){for(var a=this.components.asArray(),b=a.length,c;b--;)c=a[b],this.Do(c)},getUIContainer:function(){return this.S},getClippingUIContainer:function(){return this.jb},getHtmlMapContainer:function(){return this.Rc},Rs:function(a){var b=new l.DisplayContainer(this,a);this.da=b.da;this.Rc=b.t;this.Df=b.Df;this.Yi=b.Yi;this.S=
b.S;this.jb=b.jb;this.ko=b.ko;this.ln=b.ln;this.addEvent=function(a){b.addEvent(a)};this.removeEvent=function(a){b.removeEvent(a)};this.Qs=function(){b.containerDestroy()}},ju:function(a){var b=k.so;a.style.cssText=b?"position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;transition: opacity .5s linear;".replace(/\b(transition|transform)\b/g,b+"$1"):"";a.addEventListener?a.addEventListener(k.Qr,ovi.bind(this,this.zu),!1):this.yd&&this.da.removeChild(this.yd)},Gd:function(a,b){this.Xt=
!0;this.at=a;this.If(a,b);this.at=null;this.Xt=!1},Hf:function(a,b){this.m.resize(a,b);this.set("width",a);this.set("height",b);this.f=new d(a,b);this.aj=this.f.divide(2).round()},Jm:function(a,b,c,d){var f=this.m.capabilities.cam.fov,e=this.baseMapType;a&this.m.capabilities.ZOOM&&this.cj("zoom",b,e.min,e.max);a&m.FOV&&this.cj("fov",b,f.min,f.max,c,d)},Im:function(a){this.m&&(a&this.m.TRANSITION_START&&this.mp("start"),a&this.m.TRANSITION&&this.Fk(this.m),a&this.m.TRANSITION_END&&this.mp("end"))},
cj:function(a,b,c,d,f,e){var g=h.now();if(g-this.tm>1E3)this.dispatch(new w({type:"mapvalueexceeded",target:this.Rc,display:this,valueData:{propertyName:a,value:b,min:c,max:d,x:f,y:e}})),this.tm=g},Qo:function(){this.Vb&&this.Vb.shutdown();this.yd&&this.da.removeChild(this.yd);this.Vb=this.yd=this.xd=void 0},zu:function(a){a.target==this.yd&&a.propertyName==="opacity"&&this.Qo()},bounceEnabled:!0,bounce:function(a,b,c){this.O.inProgress||(this.m.setTransition(this.va.TRANSITION.AUTO),this.m.bounce(a,
b,c))},jg:function(a){var a=a.valueData,b=a.min,c=a.value;a.propertyName in{zoom:!0,fov:!0}&&this.bounce(c<b?!1:!0,a.x,a.y)},zt:function(a){var b=e.map.render,c=b.p2d[r&&this.default2dRenderMode==="canvas"?"canvas":"dom"].Engine;return a&4?[b.globe.Engine,b.globe.capabilities]:a&2?[b.panorama.Engine,b.panorama.capabilities]:[c,b.p2d.capabilities]},kw:function(a){return"pitch"in a&&"roll"in a&&"yaw"in a},vv:function(a){var b=this.xd,c,d,f,e=this.padding;if(this.O.inProgress)return this.va;else{this.va=
a;this.O.start();c=document.createElement("div");this.ju(c);this.hu=(f=this.Vb=this.m)&&f.getView();this.du=f&&f.getCam();d=this.yd=this.kh;if(f)c.style.visibility="hidden";this.da.insertBefore(c,d||this.Yi);if(!b)this.Rp=!0,b=f.getView();this.El=b;b=this.m=new a(c,this.baseMapType,this.Ll,{onViewChange:this.Km,onStateChange:this.Hm,onValueExceeded:this.Jm,onTransition:this.Im,onReady:this.Gm,fading:this.fading,margin:this.margin});b.setPadding(e.top,e.right,e.bottom,e.left);this.Eo();this.kh=c;return a}},
baseMapTypeSetter:function(b){b instanceof l.provider.Provider||a("baseMapType "+b);this.tu=this.baseMapType;return b},componentsSetter:function(a){var b=this.components;b.getLength()&&b.clear();return b.addAll(a)},paddingSetter:function(a){isNaN(a.top-a.right-a.bottom-a.left)&&h.d();var b=this.padding,c=this.m,d=b.top!=a.top||b.right!=a.right||b.bottom!=a.bottom||b.left!=a.left,b=d?{top:+a.top,right:+a.right,bottom:+a.bottom,left:+a.left}:b;if(d){if(!this.fixedCenter&&this.m.type!=="panorama"&&this.m.type!==
"3d"&&(this.aj=this.f.add({x:a.left-a.right,y:a.top-a.bottom}).divide(2).round(),a=c.screenToGeo(this.aj.x,this.aj.y)))c.setTransition(this.va.TRANSITION.NONE),c.setCoord(a);this.m.setPadding(b.top,b.right,b.bottom,b.left)}return b},Ln:function(a){var b=a.type==="mouseleave";this.m.setPointer(b?NaN:a.displayX,b?NaN:a.displayY)},centerSetter:function(a){var b=this.m,c=b.type==="panorama";if(this.O.inProgress)return a;this.zc("NONE");this.je||(a=c?b.setCamCoord(p.fromObject(a)):b.setCoord(p.fromObject(a)),
a=p.fromObject(a));this.je=0;return a},zoomLevelSetter:function(a){var b=h.Ja(a,this.minZoomLevel,this.maxZoomLevel);if(this.O.inProgress)return b;this.Vr(a);this.zc("NONE");return this.m.setZoom(b)},tiltSetter:function(a){a=h.Ja(a,this.minTilt,this.maxTilt);if(this.O.inProgress)return a;if(!this.je)this.je=1,a=this.m.setTilt(a);this.je=0;return a},headingSetter:function(a){a=h.Ja(a,this.minHeading,this.maxHeading);if(this.O.inProgress)return a;if(!this.je)this.je=1,a=this.m.setHeading(a);this.je=
0;return a},Vr:function(b,c,d){isNaN(b)&&a("zoomLevel");if(!this.O.inProgress&&(b>this.maxZoomLevel||b<this.minZoomLevel))return this.cj("zoom",b,this.minZoomLevel,this.maxZoomLevel,c,d),!0;return!1},dw:function(a){var b=this.m.capabilities.cam.fov;if(!this.O.inProgress&&(a>b.max||a<b.min))return this.cj("fov",a,b.min,b.max),!0;return!1},fadingSetter:function(){return this.fading},pixelToGeo:function(a,b){return p.fromObject(this.m.screenToGeo(a,b))},geoToPixel:function(a){return this.m.geoToScreen(a)},
zoomTo:function(a,b,c){a=this.m.viewForBBox(b?a.resizeToCenter(this.center):a);this.zc(c);if(a.zoom>this.maxZoomLevel)a.zoom=this.maxZoomLevel,a.distance=NaN;if(a.zoom<this.minZoomLevel)a.zoom=this.minZoomLevel,a.distance=NaN;this.m.setView(a)},getBestZoomLevel:function(a){var b=this.m,c=this.maxZoomLevel,d,f=a.length;for(isNaN(f)&&h.d();f--;)if((d=b.viewForBBox(a[f]).zoom)<c)c=d;return g(c,this.minZoomLevel)},getViewBounds:function(){return this.m&&this.m.getBBox()||this.Vb&&this.Vb.getBBox()},getObjectsWithin:function(a,
b,c,d){return this.m.getObjectsWithin(a,b,c,d)},getObjectsAt:function(a,b){return this.m.getObjectsAt(a,b)},getObjectAt:function(a,b){return this.m.getObjectAt(a,b)},Cv:function(){if(!this.nh)this.jf("start",0),this.nh=!0},zc:function(a){a=a==="default"?"auto":a;this.va.TRANSITION&&this.m.setTransition(this.va.TRANSITION[a?a.toUpperCase():"NONE"])},jf:function(a,b){this.dispatch(new u.MapViewChangeEvent({type:"mapviewchange"+a,target:this.Rc,display:this,data:b}));if(a!=="start")this.sf=0},Fk:function(a){var b,
c,d,f;if(a instanceof this.va){b=this.cd;c=a.capabilities;d=a.getView();if(b&c.COORD)a.type==="panorama"&&(f=a.getCam()),a=this.center,this.center=p.fromObject(f||d),this.gd("center",this.center,a);if(b&c.ZOOM)d.zoom<this.minZoomLevel||d.zoom>this.maxZoomLevel?this.set("zoomLevel",d.zoom):(a=this.zoomLevel,this.zoomLevel=d.zoom,a!==this.zoomLevel&&this.gd("zoomLevel",this.zoomLevel,a));if(b&c.HEADING)a=this.heading,this.heading=d.heading,this.gd("heading",this.heading,a);if(b&c.TILT)a=this.tilt,this.tilt=
d.tilt,this.gd("tilt",this.tilt,a)}this.cd=0},Km:function(a,b,c){var d=this,f=h.now(),e=f-d.pm;if(a!==d.Vb){d.cd|=b;d.sf|=b;if(d.nh){if(d.nh&&e>25)d.Fk(a),d.jf("",d.sf),d.pm=f}else d.jf("start",0),d.Fk(a),d.jf("",d.sf),d.pm=f,d.nh=!0;if(c)d.Fk(a),d.Hk&&clearTimeout(d.Hk),d.Hk=setTimeout(function(){d.sf&&d.jf("",d.sf);d.jf("end",0);d.nh=!1;d.Hk=void 0},250)}},Hm:function(a,b){this.qaOnLoad&&b==="idle"&&this.qaOnLoad(this.zoomLevel);(this.Vb||this.m)&&this.Jt(b)},xv:function(){if(this.pf)this.xd=void 0,
this.O.finish(),this.pf=!1},Jt:function(a){var b=this.m,c=this.Vb;if(a==="error"){this.O.finish();this.pf=!0;this.va=this.m=this.Vb=void 0;b.shutdown();if(c)this.xd=c.getView(),c.shutdown();u.onError&&u.onError(this.xd);this.onError&&this.onError(this.xd);return!0}return!1},Gm:function(a){var b=this,c=b.Vb,d=b.El,e=b.O,g,l={old:b.tu,current:b.baseMapType};if(a!==b.Vb){b.ps?(c&&c.setTransition(b.va.TRANSITION.AUTO),a.setTransition(b.va.TRANSITION.AUTO)):(c&&c.setTransition(b.va.TRANSITION.NONE),a.setTransition(b.va.TRANSITION.NONE));
if(b.viewBounds)b.El=d=a.viewForBBox(b.viewBounds),delete b.viewBounds;if(c&&c.type==="panorama"&&!b.xd)g=c.getCam(),d.latitude=g.latitude,d.longitude=g.longitude,d.altitude=c.convertAlt(d,"GL"),d.distance=void 0;b.Fl("start",l);if(a.type==="2d"&&d.zoom===+d.zoom)d.zoom=f(d.zoom),d.distance=void 0;a.loadDestinationCam(b.El,function(d){var f,g,h;b.kh.style.visibility="";if(c){g=f=e.getHandoverCam(a.type,c.type,d);h=b.Rp?e.getDestinationCam(a.type,c.type,d):d;if(a.type==="panorama")f=ovi.extend({},
g),g.altitude=d.altitude+52.8;a.setHandoverProperties(g);c.exit(f,function(){b.qt();a.enter(h,function(){b.O.finish();b.Rp=!1;b.Fl("end",l)})})}else g=h=d,a.setHandoverProperties(g),a.enter(h,function(){b.Fl("end",l)});a.setPadding(b.padding.top,b.padding.right,b.padding.bottom,b.padding.left);b.Hf(b.kh.offsetWidth,b.kh.offsetHeight)})}},qt:function(){this.kh.style.visibility="visible";b.msie&&b.version<10?this.Qo():this.yd&&z.Hd(this.yd,0)},mp:function(a){this.dispatch(new y({type:"transition"+a,
target:this.Rc,display:this}))},Fl:function(a,b){this.dispatch(new B({type:"basemapchange"+a,target:this.Rc,display:this,baseMapData:b}));this.pf&&a==="end"&&(this.xv(),this.dispatch(new D({type:"displayready",target:this.Rc,display:this})))},update:function(a,b){this.m&&this.m.update(a<=0?!0:!1,b);return this},uu:function(a,b,c){var b=this.zt(c.pType),a=b[0],b=b[1],d=b.view.zoom;this.set("maxZoomLevel",q(c.max,d.min,d.max));this.set("minZoomLevel",q(c.min,d.min,d.max));b.view&&(b.view.tilt&&(this.set("maxTilt",
b.view.tilt.max||0),this.set("minTilt",b.view.tilt.min||0)),b.view.heading&&(this.set("maxHeading",b.view.heading.max||0),this.set("minHeading",b.view.heading.min||0)));this.va=this.vv(a);c.us(this.m);this.va===a&&this.m.setMapProvider&&this.m.setMapProvider(c)},pan:function(a,b,c,d,f){var e=this.m;if(a-c||b-d)this.zc(f),f=this.geoToPixel(this.center),a=this.pixelToGeo(f.x+c-a,f.y+d-b),b=this.getView(),b.latitude=a.latitude,b.longitude=a.longitude,e.setView(b)},getCopyright:function(){var a=this.getViewBounds(),
b=this.zoomLevel,c=[this.baseMapType].concat(this.overlays.asArray()),d=c.length,f=0,e=[];if(a)for(;f<d;f++)c[f].getCopyrights&&(e=e.concat(c[f].getCopyrights(a,b)));for(f=e.length;f--;)a=e[f].label,f!==0&&(a=a.replace(/[0-9]{4}[,\s]+/g,"")),e[f]=a;return e.join(", ")},beginControl:function(a,b,c,d){this.O.inProgress||this.m.beginControl(a,b,c,d)},control:function(a,b,c,d,f,e,g,l){this.O.inProgress||this.m.control(a,b,c,d,f,e,g,l)},endControl:function(a){this.O.inProgress||this.m.endControl(a)},beginInteraction:function(a,
b,c,d,f,e,g){this.O.inProgress||this.m.beginInteraction(a,b,c,d,f,e,g)},interact:function(a,b,c,d,f){this.O.inProgress||this.m.interact(a,b,c,d,f)},endInteraction:function(){this.O.inProgress||this.m.endInteraction()},capture:function(a,b,c,d){var f=this.m,e,g,l;if(f.capabilities.capture){this.Xi&&(e=this.Xi.getCopyrightGfx(),g=e.getWidth(),l=e.getHeight());a=f.capture(a,b,c,d);for(b=this.components.getLength();b--;)this.components.get(b).capture(a);return this.Xi?a.drawGraphics(e,0,0,g,l,0,a.getHeight()-
l,g,l):a}}}),c=l.Display.InteractionModifiers={ZOOM:m.ZOOM,HEADING:m.HEADING,TILT:m.TILT,INCLINE:m.INCLINE,COORD:m.COORD,SIZE:m.SIZE};l.Display.prototype.InteractionModifiers={};h.flatMerge(l.Display.prototype.InteractionModifiers,c);h.flatMerge(l.Display,v.constants);h.flatMerge(l.Display.prototype,v.constants);var c=l.Display.MapViewChangeEvent=function(a){z.Event.call(this,a)},x={MAPVIEWCHANGE_ZOOM:m.ZOOM,MAPVIEWCHANGE_HEADING:m.HEADING,MAPVIEWCHANGE_TILT:m.TILT,MAPVIEWCHANGE_INCLINE:m.INCLINE,
MAPVIEWCHANGE_CENTER:m.COORD,MAPVIEWCHANGE_SIZE:m.SIZE};h.flatMerge(c,x);x.data=0;h.flatMerge(c.prototype=new z.Event,x);var w=l.Display.MapValueExceededEvent=function(a){z.Event.call(this,a)},y=l.Display.TransitionEvent=function(a){z.Event.call(this,a)},B=l.Display.BaseMapChangeEvent=function(a){z.Event.call(this,a)};B.baseMapData={old:void 0,current:void 0};B.prototype=new z.Event;var D=l.Display.DisplayReadyEvent=function(a){z.Event.call(this,a)};x.valueData={value:"",propertyName:"",min:null,
max:null};w.prototype=new z.Event})(nokia.maps);ovi.provide("nokia.maps.map._packaging.package");ovi.provide("nokia.maps.map.render.p2d.dom.Engine");
(function(){var e=nokia.maps,k=e.dom,h=e.util,d=h.Coroutine,c=new h.Matrix3D,g=e.css,b=g.applyMatrix,f=Math,q=f.log,a=f.LN2,r=f.round,l=[-256,-256,-256,-256],e=e.map.render.p2d,f=e.dom;f.Engine=new ovi.Class({Extends:e.Engine,initialize:function(){this.tn={};this.Zq=this.gv(this);this.Gj=c;this._super.apply(this,arguments)},Statics:{TRANSITION:e.Engine.TRANSITION},lj:f,setMapProvider:function(a){var b=this;b._super(a);k.zp(b.lh.ownerDocument,function(a){b.bw(a,b.Ol)})},shutdown:function(){this._super();
d.kill(this.Zq)},Ir:null,bw:function(a,b){var c=this.lh.className=this.Zi+"MapLayer",d=null;b>0&&(b/=1E3,d=k.Ao(a,"."+c+" ."+this.Zi+"Tile",g.so+"transition: opacity "+b+"s linear;position: absolute;"));k.Vq(a,this.Ir);this.Ir=d},se:function(a,b,c,d){var f=a.ownerDocument;d?d=f.createComment("comment"):(d=f.createElement("div"),d.style.position="absolute",d.style.zIndex=0);c?a.replaceChild(d,b):a.insertBefore(d,b||null);return d},update:function(a,b){var c=this,f=c.Zq,e=f.scope;if(c.ns&&!c.dh){c.dh=
!0;c.kl(!0);if(a)e.cacheOnly=b,f.run(!0,!0);else{if(b){var g=function(){e.cacheOnly=!0;d.signal(c.tn);c.jd=h.requestAnimationFrame(g)};!c.jd&&g()}h.cancelAnimationFrame(c.jd);c.jd=0;if(!c.Gf)c.Gf=setTimeout(function(){e.cacheOnly=!1;d.signal(c.tn);c.Gf=0},300)}c.dh=!1}},gv:d.create("nokia.maps.map.render.p2d.Engine#_renderCo",function(f){var e=f.that,g=f.cacheOnly,h,k=f.i,u=e.Bd,x=u.length;h=f.Aj;var w=e.pb;h&&h.x!==e.mb.x&&h.y!==e.mb.y&&(k=void 0);e.Jf("busy");if(k===void 0&&(e.Fj=e.$e,h=e.rf))b(h.o,
e.Gj=c.translate(w.x,w.y,0)),h.render(e.B.zoom,e.mb,e.Z,e.Cd,e.Wa,w,e.Yg(l),0,0,0,e.B.zoom-r(q(h.e.width/256)/a),g,e.$b);k=k||0;if(!g&&d.shallYield())return e.jr(f,k),d.yield();for(;k<x;){if(h=u[k++])b(h.o,e.Gj),h.render(e.B.zoom,e.mb,e.Z,e.Cd,e.Wa,w,e.Yg(l),0,0,0,void 0,g,e.$b,e.lb);if(!g&&k!==x&&d.shallYield())return e.jr(f,k),d.yield()}if(!g)e.$b.x=w.x,e.$b.y=w.y;f.i=f.Aj=void 0;e.eu=e.fu=0;return d.wait(e.tn)},"that"),sa:function(a){b(a,this.Gj=this.Gj.translate(this.pb.x,this.pb.y,0))}})})();
ovi.provide("nokia.maps.map._packaging.package-render-display");})();
